# 18.1 å¤šæ™ºèƒ½ä½“åä½œæ¨¡å¼

> **è®¾è®¡æ€æƒ³**ï¼šå¤šæ™ºèƒ½ä½“ç³»ç»Ÿå°±åƒä¸€ä¸ªé«˜æ•ˆçš„å›¢é˜Ÿ,ä¸åŒæˆå‘˜å„å¸å…¶èŒã€ç›¸äº’åä½œã€‚ç†è§£åä½œæ¨¡å¼çš„æœ¬è´¨,å°±æ˜¯ç†è§£å¦‚ä½•è®©AIæ™ºèƒ½ä½“åƒäººç±»å›¢é˜Ÿä¸€æ ·é«˜æ•ˆå·¥ä½œã€‚

## å¼•è¨€ï¼šä»å•å…µä½œæˆ˜åˆ°å›¢é˜Ÿåä½œ

æƒ³è±¡ä¸€ä¸‹,ä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªå¤æ‚çš„è½¯ä»¶ç³»ç»Ÿã€‚ä¸€ä¸ªç¨‹åºå‘˜å¯ä»¥å®Œæˆç®€å•åŠŸèƒ½,ä½†å½“é¡¹ç›®è§„æ¨¡æ‰©å¤§æ—¶,ä½ éœ€è¦ï¼š
- å‰ç«¯å·¥ç¨‹å¸ˆè´Ÿè´£ç”¨æˆ·ç•Œé¢
- åç«¯å·¥ç¨‹å¸ˆå¤„ç†ä¸šåŠ¡é€»è¾‘
- æµ‹è¯•å·¥ç¨‹å¸ˆä¿è¯è´¨é‡
- é¡¹ç›®ç»ç†åè°ƒè¿›åº¦

**å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼ˆMulti-Agent System, MASï¼‰å°±æ˜¯è¿™æ ·çš„AIå›¢é˜Ÿã€‚** æ¯ä¸ªæ™ºèƒ½ä½“åƒå›¢é˜Ÿæˆå‘˜ä¸€æ ·æœ‰è‡ªå·±çš„ä¸“é•¿,é€šè¿‡åä½œè§£å†³å¤æ‚é—®é¢˜ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦å¤šæ™ºèƒ½ä½“ç³»ç»Ÿï¼Ÿ

åœ¨ç¬¬17ç« ä¸­,æˆ‘ä»¬å­¦ä¹ äº†å•ä¸ªæ™ºèƒ½ä½“çš„èƒ½åŠ›ã€‚ä½†ç°å®ä¸–ç•Œçš„AIåº”ç”¨å¾€å¾€éœ€è¦ï¼š

1. **ä¸“ä¸šåˆ†å·¥** - ä¸åŒä»»åŠ¡éœ€è¦ä¸åŒçš„ä¸“ä¸šèƒ½åŠ›
2. **å¹¶è¡Œå¤„ç†** - å¤šä¸ªä»»åŠ¡åŒæ—¶è¿›è¡Œæé«˜æ•ˆç‡
3. **å®¹é”™èƒ½åŠ›** - ä¸€ä¸ªæ™ºèƒ½ä½“å¤±è´¥ä¸å½±å“æ•´ä½“ç³»ç»Ÿ
4. **å¯æ‰©å±•æ€§** - éšæ—¶å¢åŠ æ–°çš„æ™ºèƒ½ä½“åº”å¯¹æ–°éœ€æ±‚

```mermaid
graph LR
    A[å¤æ‚ä»»åŠ¡] --> B{ä»»åŠ¡åˆ†è§£}
    B --> C[å­ä»»åŠ¡1]
    B --> D[å­ä»»åŠ¡2]
    B --> E[å­ä»»åŠ¡3]
    C --> F[Agent 1]
    D --> G[Agent 2]
    E --> H[Agent 3]
    F --> I[ç»“æœæ±‡æ€»]
    G --> I
    H --> I
    I --> J[æœ€ç»ˆç»“æœ]
    
    style A fill:#ff6b6b
    style J fill:#51cf66
    style B fill:#ffd43b
```

## å­¦ä¹ ç›®æ ‡

å®Œæˆæœ¬èŠ‚å­¦ä¹ å,ä½ å°†ï¼š

- âœ… **ç†è§£åä½œæ¨¡å¼çš„æœ¬è´¨** - æŒæ¡é›†ä¸­å¼ã€åˆ†å¸ƒå¼ç­‰ä¸åŒæ¶æ„çš„è®¾è®¡ç†å¿µ
- âœ… **æŒæ¡ä¸»ä»å¼åä½œ** - ç†è§£æœ‰é¢†å¯¼çš„å›¢é˜Ÿå¦‚ä½•é«˜æ•ˆå·¥ä½œ
- âœ… **å®ç°å¯¹ç­‰å¼åä½œ** - å­¦ä¼šæ„å»ºå¹³ç­‰åä½œçš„æ™ºèƒ½ä½“ç½‘ç»œ
- âœ… **ç†è§£è”ç›Ÿå¼åä½œ** - æŒæ¡åŠ¨æ€ç»„é˜Ÿå’Œä»»åŠ¡åˆ†é…æœºåˆ¶
- âœ… **é€‰æ‹©åˆé€‚çš„æ¨¡å¼** - æ ¹æ®å®é™…åœºæ™¯åšå‡ºæ­£ç¡®çš„æ¶æ„å†³ç­–

## å¤šæ™ºèƒ½ä½“ç³»ç»ŸåŸºç¡€

### 1. æ ¸å¿ƒæ¦‚å¿µ

åœ¨æ·±å…¥åä½œæ¨¡å¼ä¹‹å‰,æˆ‘ä»¬å…ˆç†è§£ä»€ä¹ˆæ˜¯æ™ºèƒ½ä½“ï¼ˆAgentï¼‰ã€‚ä¸€ä¸ªæ™ºèƒ½ä½“å¿…é¡»å…·å¤‡å››ä¸ªå…³é”®ç‰¹æ€§ï¼š

```mermaid
graph LR
    A[æ™ºèƒ½ä½“<br/>Agent] --> B[è‡ªä¸»æ€§<br/>Autonomy]
    A --> C[ååº”æ€§<br/>Reactivity]
    A --> D[ä¸»åŠ¨æ€§<br/>Proactivity]
    A --> E[ç¤¾ä¼šæ€§<br/>Sociability]
    
    B --> B1[ç‹¬ç«‹è¿è¡Œ<br/>è‡ªä¸»å†³ç­–]
    C --> C1[æ„ŸçŸ¥ç¯å¢ƒ<br/>å¿«é€Ÿå“åº”]
    D --> D1[ä¸»åŠ¨è¡ŒåŠ¨<br/>ç›®æ ‡å¯¼å‘]
    E --> E1[äº¤äº’åä½œ<br/>ä¿¡æ¯äº¤æ¢]
    
    style A fill:#339af0
    style B fill:#51cf66
    style C fill:#ffd43b
    style D fill:#ff6b6b
    style E fill:#a855f7
```

**è®¾è®¡ç†å¿µ**ï¼šæŠŠæ™ºèƒ½ä½“æƒ³è±¡æˆä¸€ä¸ªæœ‰æ€æƒ³çš„å›¢é˜Ÿæˆå‘˜,ä»–ä¸ä»…èƒ½è‡ªå·±å·¥ä½œ,è¿˜èƒ½ä¸å…¶ä»–æˆå‘˜æ²Ÿé€šåä½œã€‚

### 2. æ™ºèƒ½ä½“çš„Javaå®ç°

æˆ‘ä»¬ä½¿ç”¨æŠ½è±¡ç±»å®šä¹‰æ™ºèƒ½ä½“çš„åŸºæœ¬ç»“æ„ï¼š

```java
public abstract class Agent {
    protected String agentId;        // å”¯ä¸€æ ‡è¯†
    protected String name;           // æ™ºèƒ½ä½“åç§°
    protected AgentState state;      // å½“å‰çŠ¶æ€
    
    // æ ¸å¿ƒæ–¹æ³•ï¼šå­ç±»å¿…é¡»å®ç°
    public abstract void initialize();  
    public abstract AgentResponse processMessage(AgentMessage message);  
    public abstract void shutdown();
    
    // é€šä¿¡èƒ½åŠ›
    public void sendMessage(AgentMessage message) { /* ... */ }
    public void receiveMessage(AgentMessage message) { /* ... */ }
}
```

**è®¾è®¡äº®ç‚¹**ï¼š
- **æŠ½è±¡ç±»è®¾è®¡**ï¼šæä¾›é€šç”¨å®ç°,å‡å°‘é‡å¤ä»£ç 
- **çŠ¶æ€æœºæ¨¡å¼**ï¼šä¾¿äºè·Ÿè¸ªæ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸ
- **æ¶ˆæ¯å¼é€šä¿¡**ï¼šå®ç°è§£è€¦,æé«˜çµæ´»æ€§

### 3. å¤šæ™ºèƒ½ä½“ç³»ç»Ÿæ¶æ„è§†å›¾

```mermaid
graph TB
    subgraph "æ™ºèƒ½ä½“å±‚"
        A1[Agent 1<br/>åˆ†æå¸ˆ]
        A2[Agent 2<br/>ç ”ç©¶å‘˜]
        A3[Agent 3<br/>æ‰§è¡Œå‘˜]
        A4[Agent N<br/>...]
    end
    
    subgraph "é€šä¿¡å±‚"
        Bus[æ¶ˆæ¯æ€»çº¿<br/>Message Bus]
    end
    
    subgraph "ç¯å¢ƒå±‚"
        Env[å…±äº«ç¯å¢ƒ<br/>Environment]
    end
    
    A1 <--> Bus
    A2 <--> Bus
    A3 <--> Bus
    A4 <--> Bus
    
    Bus <--> Env
    
    style A1 fill:#e1f5ff
    style A2 fill:#e1f5ff
    style A3 fill:#e1f5ff
    style A4 fill:#e1f5ff
    style Bus fill:#fff3e0
    style Env fill:#f1f8e9
```

**æ¶æ„è¯´æ˜**ï¼š
- **æ™ºèƒ½ä½“å±‚**ï¼šå¤šä¸ªç‹¬ç«‹çš„æ™ºèƒ½ä½“,å„è‡ªæ‰§è¡Œä¸åŒä»»åŠ¡
- **é€šä¿¡å±‚**ï¼šæ¶ˆæ¯æ€»çº¿è´Ÿè´£è·¯ç”±å’Œä¼ é€’æ¶ˆæ¯
- **ç¯å¢ƒå±‚**ï¼šå…±äº«çš„æ•°æ®å’Œèµ„æºç©ºé—´

---

## ä¸€ã€é›†ä¸­å¼åä½œæ¨¡å¼ï¼šæŒ‡æŒ¥å®˜å¼ç®¡ç†

### 1. æ ¸å¿ƒæ€æƒ³

é›†ä¸­å¼åä½œå°±åƒä¸€ä¸ªäº¤å“ä¹å›¢,æœ‰ä¸€ä¸ªæŒ‡æŒ¥å®¶ç»Ÿä¸€åè°ƒæ‰€æœ‰éŸ³ä¹å®¶çš„æ¼”å¥ã€‚**ä¸­å¤®æ§åˆ¶å™¨**è´Ÿè´£ï¼š
- ä»»åŠ¡åˆ†é…ï¼šå†³å®šè°æ¥åšä»€ä¹ˆ
- è´Ÿè½½å‡è¡¡ï¼šç¡®ä¿å·¥ä½œé‡åˆ†é…åˆç†
- çŠ¶æ€ç›‘æ§ï¼šå®æ—¶æŒæ¡æ¯ä¸ªæ™ºèƒ½ä½“çš„æƒ…å†µ

```mermaid
graph TB
    Controller["ä¸­å¤®æ§åˆ¶å™¨<br/>ğŸ¯ æŒ‡æŒ¥å®˜"]
    
    Controller --> A1["Agent 1<br/>ğŸ‘¤ åˆ†æå¸ˆ"]
    Controller --> A2["Agent 2<br/>ğŸ‘¤ ç ”ç©¶å‘˜"]
    Controller --> A3["Agent 3<br/>ğŸ‘¤ æ‰§è¡Œå‘˜"]
    Controller --> A4["Agent 4<br/>ğŸ‘¤ è¯„å®¡å‘˜"]
    
    A1 -.åé¦ˆ.-> Controller
    A2 -.åé¦ˆ.-> Controller
    A3 -.åé¦ˆ.-> Controller
    A4 -.åé¦ˆ.-> Controller
    
    style Controller fill:#ff6b6b,color:#fff
    style A1 fill:#4ecdc4
    style A2 fill:#4ecdc4
    style A3 fill:#4ecdc4
    style A4 fill:#4ecdc4
```

### 2. ä¼˜ç¼ºç‚¹åˆ†æ

| ç»´åº¦ | ä¼˜åŠ¿ âœ… | åŠ£åŠ¿ âŒ |
|------|---------|----------|
| **æ§åˆ¶æ€§** | ç»Ÿä¸€ç®¡ç†,é€»è¾‘æ¸…æ™° | ä¸­å¤®æ•…éšœå¯¼è‡´ç³»ç»Ÿå¤±æ•ˆ |
| **æ€§èƒ½** | æ²¡æœ‰é€šä¿¡å¼€é”€,å†³ç­–å¿« | ä¸­å¤®èŠ‚ç‚¹æˆä¸ºæ€§èƒ½ç“¶é¢ˆ |
| **å¯ç»´æŠ¤æ€§** | é›†ä¸­ç®¡ç†,æ˜“äºè°ƒè¯• | é€»è¾‘é›†ä¸­,ä¿®æ”¹å½±å“å¤§ |
| **æ‰©å±•æ€§** | æ·»åŠ æ™ºèƒ½ä½“ç®€å• | éš¾ä»¥æ°´å¹³æ‰©å±• |

### 3. å…³é”®å®ç°

```java
public class CentralizedMultiAgentSystem {
    private CentralController controller;        // ä¸­å¤®æ§åˆ¶å™¨
    private Map<String, Agent> agents;           // æ™ºèƒ½ä½“æ± 
    
    public AgentResponse sendMessage(AgentMessage message) {
        // æ‰€æœ‰æ¶ˆæ¯éƒ½é€šè¿‡ä¸­å¤®æ§åˆ¶å™¨è·¯ç”±
        return controller.routeMessage(message);
    }
}

class CentralController {
    private TaskScheduler taskScheduler;     // ä»»åŠ¡è°ƒåº¦
    private LoadBalancer loadBalancer;       // è´Ÿè½½å‡è¡¡
    private SystemMonitor systemMonitor;     // ç³»ç»Ÿç›‘æ§
    
    public AgentResponse routeMessage(AgentMessage message) {
        // 1. é€‰æ‹©æœ€ä½³æ™ºèƒ½ä½“
        String targetAgentId = loadBalancer.selectAgent(message);
        
        // 2. åˆ›å»ºä»»åŠ¡
        Task task = taskScheduler.createTask(message, targetAgentId);
        
        // 3. æ‰§è¡Œå¹¶ç›‘æ§
        AgentResponse response = executeTask(task);
        systemMonitor.recordTaskExecution(task, response);
        
        return response;
    }
}
```

**è®¾è®¡äº®ç‚¹**ï¼š
- **åˆ†ç¦»å…³æ³¨**ï¼šè°ƒåº¦ã€å‡è¡¡ã€ç›‘æ§å„å¸å…¶èŒ
- **ç»Ÿä¸€å…¥å£**ï¼šæ‰€æœ‰æ¶ˆæ¯ç»è¿‡controllerè·¯ç”±
- **å¯ç›‘æ§æ€§**ï¼šè®°å½•æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œæƒ…å†µ

### 4. é€‚ç”¨åœºæ™¯

âœ… **é€‚åˆä½¿ç”¨**ï¼š
- æ™ºèƒ½ä½“æ•°é‡å°‘ï¼ˆ<20ï¼‰
- ä»»åŠ¡æ‰§è¡Œæ—¶é—´çŸ­
- éœ€è¦ä¸¥æ ¼çš„ä»»åŠ¡ä¼˜å…ˆçº§æ§åˆ¶
- éœ€è¦é›†ä¸­ç›‘æ§å’Œç®¡ç†

âŒ **ä¸é€‚åˆä½¿ç”¨**ï¼š
- å¤§è§„æ¨¡åˆ†å¸ƒå¼ç³»ç»Ÿ
- é«˜å¯ç”¨æ€§è¦æ±‚ï¼ˆå•ç‚¹æ•…éšœé£é™©ï¼‰
- æ™ºèƒ½ä½“éœ€è¦è‡ªä¸»å†³ç­–

---

## äºŒã€åˆ†å¸ƒå¼åä½œæ¨¡å¼ï¼šè‡ªç»„ç»‡ç½‘ç»œ

### 1. æ ¸å¿ƒæ€æƒ³

åˆ†å¸ƒå¼åä½œåƒä¸€ä¸ªè‡ªç»„ç»‡çš„ç¤¾åŒº,æ¯ä¸ªæˆå‘˜éƒ½æœ‰å¹³ç­‰çš„åœ°ä½,é€šè¿‡ç›¸äº’åå•†å®Œæˆä»»åŠ¡ã€‚æ²¡æœ‰ä¸­å¤®æ§åˆ¶å™¨,æ™ºèƒ½ä½“ä¹‹é—´ç›´æ¥é€šä¿¡ã€‚

```mermaid
graph TB
    A1["Agent 1<br/>ğŸ¤– åˆ†æå¸ˆ"]
    A2["Agent 2<br/>ğŸ¤– ç ”ç©¶å‘˜"]
    A3["Agent 3<br/>ğŸ¤– æ‰§è¡Œå‘˜"]
    A4["Agent 4<br/>ğŸ¤– è¯„å®¡å‘˜"]
    
    A1 <--> A2
    A1 <--> A3
    A1 <--> A4
    A2 <--> A3
    A2 <--> A4
    A3 <--> A4
    
    style A1 fill:#51cf66
    style A2 fill:#51cf66
    style A3 fill:#51cf66
    style A4 fill:#51cf66
```

### 2. ä¼˜ç¼ºç‚¹å¯¹æ¯”

| ç»´åº¦ | ä¼˜åŠ¿ âœ… | åŠ£åŠ¿ âŒ |
|------|---------|----------|
| **å¯é æ€§** | æ— å•ç‚¹æ•…éšœ,é«˜å¯ç”¨ | åè°ƒå¤æ‚,å¯èƒ½å†²çª |
| **æ‰©å±•æ€§** | æ˜“äºæ°´å¹³æ‰©å±• | é€šä¿¡å¼€é”€å¤§ |
| **çµæ´»æ€§** | æ™ºèƒ½ä½“è‡ªä¸»å†³ç­– | å…¨å±€ä¼˜åŒ–å›°éš¾ |
| **å¤æ‚åº¦** | å±€éƒ¨é€»è¾‘ç®€å• | æ•´ä½“è¡Œä¸ºéš¾é¢„æµ‹ |

### 3. å…³é”®ç»„ä»¶

åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ ¸å¿ƒæ˜¯**æœåŠ¡å‘ç°**å’Œ**æ¶ˆæ¯è·¯ç”±**ï¼š

```java
public class DistributedMultiAgentSystem {
    private Map<String, Agent> agents;
    private DiscoveryService discoveryService;    // æœåŠ¡å‘ç°
    private MessageRouter messageRouter;          // æ¶ˆæ¯è·¯ç”±
    
    public void sendMessage(AgentMessage message) {
        // ç‚¹å¯¹ç‚¹ç›´æ¥é€šä¿¡
        messageRouter.routeMessage(message);
    }
}

class DiscoveryService {
    // æ³¨å†Œæ™ºèƒ½ä½“
    public void registerAgent(Agent agent) { /* ... */ }
    
    // å‘ç°å…·æœ‰ç‰¹å®šèƒ½åŠ›çš„æ™ºèƒ½ä½“
    public List<AgentInfo> discoverAgents(String capability) { /* ... */ }
}
```

**è®¾è®¡è¦ç‚¹**ï¼š
- **æœåŠ¡å‘ç°**ï¼šæ™ºèƒ½ä½“èƒ½æ‰¾åˆ°åˆé€‚çš„åä½œä¼™ä¼´
- **ç‚¹å¯¹ç‚¹é€šä¿¡**ï¼šå‡å°‘ä¸­ä»‹,æé«˜æ•ˆç‡
- **è‡ªä¸»åå•†**ï¼šæ™ºèƒ½ä½“è‡ªå·±å†³å®šå¦‚ä½•åä½œ

### 4. æ¶ˆæ¯è·¯ç”±æœºåˆ¶

```mermaid
sequenceDiagram
    participant A1 as Agent 1
    participant R as Message Router
    participant D as Discovery
    participant A2 as Agent 2
    
    A1->>R: å‘é€æ¶ˆæ¯
    R->>D: æŸ¥æ‰¾ç›®æ ‡Agent
    D-->>R: è¿”å›Agent 2åœ°å€
    R->>A2: è½¬å‘æ¶ˆæ¯
    A2->>A2: å¤„ç†æ¶ˆæ¯
    A2-->>R: è¿”å›å“åº”
    R-->>A1: è½¬å‘å“åº”
```

---

## ä¸‰ã€ä¸»ä»å¼åä½œæ¨¡å¼ï¼šæœ‰é¢†å¯¼çš„å›¢é˜Ÿ

### 1. æ ¸å¿ƒæ€æƒ³

ä¸»ä»å¼åä½œåƒä¸€ä¸ªæœ‰é¡¹ç›®ç»ç†çš„å¼€å‘å›¢é˜Ÿã€‚**ä¸»æ™ºèƒ½ä½“ï¼ˆMasterï¼‰** è´Ÿè´£ä»»åŠ¡åˆ†è§£å’Œåè°ƒ,**ä»æ™ºèƒ½ä½“ï¼ˆWorkerï¼‰** æ‰§è¡Œå…·ä½“å·¥ä½œã€‚

```mermaid
graph TB
    Master["ä¸»æ™ºèƒ½ä½“<br/>ğŸ“‹ åè°ƒè€…"]
    
    Master -->|åˆ†é…ä»»åŠ¡| W1["Worker 1<br/>âš™ï¸ æ‰§è¡Œè€…"]
    Master -->|åˆ†é…ä»»åŠ¡| W2["Worker 2<br/>âš™ï¸ æ‰§è¡Œè€…"]
    Master -->|åˆ†é…ä»»åŠ¡| W3["Worker 3<br/>âš™ï¸ æ‰§è¡Œè€…"]
    
    W1 -.å®ŒæˆæŠ¥å‘Š.-> Master
    W2 -.å®ŒæˆæŠ¥å‘Š.-> Master
    W3 -.å®ŒæˆæŠ¥å‘Š.-> Master
    
    style Master fill:#ffd43b
    style W1 fill:#a855f7
    style W2 fill:#a855f7
    style W3 fill:#a855f7
```

### 2. å·¥ä½œæµç¨‹

```mermaid
sequenceDiagram
    participant U as User
    participant M as Master Agent
    participant W1 as Worker 1
    participant W2 as Worker 2
    
    U->>M: æäº¤å¤æ‚ä»»åŠ¡
    M->>M: ä»»åŠ¡åˆ†è§£
    
    par å¹¶è¡Œæ‰§è¡Œ
        M->>W1: åˆ†é…å­ä»»åŠ¡1
        M->>W2: åˆ†é…å­ä»»åŠ¡2
    end
    
    W1->>W1: æ‰§è¡Œä»»åŠ¡1
    W2->>W2: æ‰§è¡Œä»»åŠ¡2
    
    W1-->>M: è¿”å›ç»“æœ1
    W2-->>M: è¿”å›ç»“æœ2
    
    M->>M: ç»“æœæ±‡æ€»
    M-->>U: è¿”å›æœ€ç»ˆç»“æœ
```

### 3. æ ¸å¿ƒå®ç°

```java
class MasterAgent extends Agent {
    private List<Agent> workers;
    
    @Override
    public AgentResponse processMessage(AgentMessage message) {
        // 1. ä»»åŠ¡åˆ†è§£
        List<SubTask> subTasks = decomposeTask(message);
        
        // 2. å¹¶è¡Œåˆ†é…
        List<CompletableFuture<AgentResponse>> futures = 
            subTasks.stream()
                   .map(task -> assignToWorker(task))
                   .collect(Collectors.toList());
        
        // 3. ç­‰å¾…å®Œæˆ
        CompletableFuture.allOf(futures.toArray(new CompletableFuture[0]))
                        .join();
        
        // 4. ç»“æœæ±‡æ€»
        return aggregateResults(futures);
    }
    
    private CompletableFuture<AgentResponse> assignToWorker(SubTask task) {
        Worker worker = selectAvailableWorker();
        return worker.executeAsync(task);
    }
}
```

### 4. é€‚ç”¨åœºæ™¯

âœ… **æœ€ä½³å®è·µ**ï¼š
- Map-Reduceç±»å‹çš„ä»»åŠ¡
- æ•°æ®å¹¶è¡Œå¤„ç†
- éœ€è¦ç»“æœæ±‡æ€»çš„åœºæ™¯

---

## å››ã€å¯¹ç­‰å¼åä½œæ¨¡å¼ï¼šå¹³ç­‰åå•†

### 1. æ ¸å¿ƒæ€æƒ³

å¯¹ç­‰å¼åä½œä¸­,æ‰€æœ‰æ™ºèƒ½ä½“åœ°ä½å¹³ç­‰,é€šè¿‡åå•†å’ŒæŠ•ç¥¨åšå†³ç­–ã€‚ç±»ä¼¼äºæ•æ·å›¢é˜Ÿçš„ç«™ä¼šã€‚

```mermaid
graph TB
    subgraph "åå•†è¿‡ç¨‹"
        A1[Agent 1<br/>æè®®æ–¹æ¡ˆA]
        A2[Agent 2<br/>æè®®æ–¹æ¡ˆB]
        A3[Agent 3<br/>è¯„ä¼°æ–¹æ¡ˆ]
        A4[Agent 4<br/>æŠ•ç¥¨å†³ç­–]
    end
    
    A1 -.åå•†.-> A2
    A2 -.åå•†.-> A3
    A3 -.åå•†.-> A4
    A4 -.åå•†.-> A1
    
    style A1 fill:#e1f5ff
    style A2 fill:#e1f5ff
    style A3 fill:#e1f5ff
    style A4 fill:#e1f5ff
```

### 2. å…±è¯†ç®—æ³•

```java
class PeerAgent extends Agent {
    public ConsensusResult reachConsensus(Proposal proposal) {
        // 1. å¹¿æ’­ææ¡ˆ
        broadcastProposal(proposal);
        
        // 2. æ”¶é›†æŠ•ç¥¨
        Map<String, Vote> votes = collectVotes(proposal.getId());
        
        // 3. è®¡ç®—ç»“æœ
        int agreeCount = (int) votes.values().stream()
            .filter(v -> v.isAgree())
            .count();
        
        // 4. è¾¾æˆå…±è¯†ï¼ˆè¶…è¿‡2/3åŒæ„ï¼‰
        return agreeCount > votes.size() * 2 / 3 
            ? ConsensusResult.AGREED 
            : ConsensusResult.REJECTED;
    }
}
```

---

## äº”ã€è”ç›Ÿå¼åä½œæ¨¡å¼ï¼šåŠ¨æ€ç»„é˜Ÿ

### 1. æ ¸å¿ƒæ€æƒ³

æ™ºèƒ½ä½“æ ¹æ®ä»»åŠ¡éœ€æ±‚åŠ¨æ€ç»„å»ºè”ç›Ÿ,å®Œæˆä»»åŠ¡åè§£æ•£ã€‚åƒæ˜¯ä¸´æ—¶é¡¹ç›®ç»„ã€‚

```mermaid
graph TB
    T[æ–°ä»»åŠ¡åˆ°æ¥]
    T --> F[ç»„å»ºè”ç›Ÿ]
    
    F --> C1["è”ç›Ÿ1<br/>Agent A+B"]
    F --> C2["è”ç›Ÿ2<br/>Agent C+D+E"]
    
    C1 --> E1[æ‰§è¡Œä»»åŠ¡1]
    C2 --> E2[æ‰§è¡Œä»»åŠ¡2]
    
    E1 --> D1[è§£æ•£è”ç›Ÿ1]
    E2 --> D2[è§£æ•£è”ç›Ÿ2]
    
    style T fill:#ff6b6b
    style F fill:#ffd43b
    style C1 fill:#51cf66
    style C2 fill:#51cf66
```

### 2. è”ç›Ÿç”Ÿå‘½å‘¨æœŸ

```java
class CoalitionManager {
    public String formCoalition(Task task) {
        // 1. åˆ†æä»»åŠ¡éœ€æ±‚
        Set<String> requiredCapabilities = analyzeTask(task);
        
        // 2. é€‰æ‹©åˆé€‚çš„æ™ºèƒ½ä½“
        List<Agent> candidates = findCapableAgents(requiredCapabilities);
        
        // 3. åˆ›å»ºè”ç›Ÿ
        Coalition coalition = new Coalition(UUID.randomUUID().toString());
        candidates.forEach(coalition::addMember);
        
        // 4. åˆ†é…ä»»åŠ¡
        coalition.assignTask(task);
        
        return coalition.getId();
    }
}
```

---

## åä½œæ¨¡å¼é€‰æ‹©æŒ‡å—

å¦‚ä½•ä¸ºä½ çš„åº”ç”¨é€‰æ‹©åˆé€‚çš„åä½œæ¨¡å¼ï¼Ÿå‚è€ƒä»¥ä¸‹å†³ç­–æ ‘ï¼š

```mermaid
graph TD
    Start[å¼€å§‹é€‰æ‹©] --> Q1{æ™ºèƒ½ä½“æ•°é‡?}
    
    Q1 -->|å°‘äº10ä¸ª| Q2{éœ€è¦é›†ä¸­æ§åˆ¶?}
    Q1 -->|10-50ä¸ª| Q3{ä»»åŠ¡å¯åˆ†è§£?}
    Q1 -->|è¶…è¿‡50ä¸ª| Distributed[åˆ†å¸ƒå¼æ¨¡å¼]
    
    Q2 -->|æ˜¯| Centralized[é›†ä¸­å¼æ¨¡å¼]
    Q2 -->|å¦| Peer[å¯¹ç­‰å¼æ¨¡å¼]
    
    Q3 -->|æ˜¯| MasterWorker[ä¸»ä»å¼æ¨¡å¼]
    Q3 -->|å¦| Coalition[è”ç›Ÿå¼æ¨¡å¼]
    
    style Start fill:#339af0
    style Centralized fill:#51cf66
    style Distributed fill:#51cf66
    style MasterWorker fill:#51cf66
    style Peer fill:#51cf66
    style Coalition fill:#51cf66
```

### æ¨¡å¼å¯¹æ¯”æ€»ç»“è¡¨

| æ¨¡å¼ | é€‚ç”¨è§„æ¨¡ | å¤æ‚åº¦ | å¯é æ€§ | æ€§èƒ½ | æœ€ä½³åœºæ™¯ |
|------|---------|--------|--------|------|---------|
| **é›†ä¸­å¼** | å° | â­â­ | â­â­ | â­â­â­â­ | ç®€å•ä»»åŠ¡åˆ†é… |
| **åˆ†å¸ƒå¼** | å¤§ | â­â­â­â­ | â­â­â­â­ | â­â­â­ | å¤§è§„æ¨¡ç³»ç»Ÿ |
| **ä¸»ä»å¼** | ä¸­ | â­â­â­ | â­â­â­ | â­â­â­â­ | å¹¶è¡Œè®¡ç®— |
| **å¯¹ç­‰å¼** | ä¸­å° | â­â­â­ | â­â­â­ | â­â­ | éœ€è¦å…±è¯†å†³ç­– |
| **è”ç›Ÿå¼** | ä¸­å¤§ | â­â­â­â­ | â­â­â­â­ | â­â­â­ | åŠ¨æ€ä»»åŠ¡åä½œ |

---

## å®æˆ˜æ¡ˆä¾‹ï¼šæ™ºèƒ½å®¢æœç³»ç»Ÿ

è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå®é™…æ¡ˆä¾‹,çœ‹çœ‹å¦‚ä½•åº”ç”¨è¿™äº›åä½œæ¨¡å¼ã€‚

### ç³»ç»Ÿæ¶æ„

```mermaid
graph TB
    User[ç”¨æˆ·å’¨è¯¢]
    
    User --> Router[è·¯ç”±Agent<br/>é›†ä¸­å¼]
    
    Router --> Intent[æ„å›¾è¯†åˆ«Agent]
    Router --> KB[çŸ¥è¯†åº“Agent]
    Router --> Action[æ‰§è¡ŒAgent]
    
    Intent --> Team[ä¸“å®¶å›¢é˜Ÿ<br/>å¯¹ç­‰å¼åå•†]
    Team --> E1[äº§å“ä¸“å®¶]
    Team --> E2[æŠ€æœ¯ä¸“å®¶]
    Team --> E3[å”®åä¸“å®¶]
    
    KB --> Search[æœç´¢è”ç›Ÿ<br/>è”ç›Ÿå¼]
    
    Action --> Workers[æ‰§è¡Œå›¢é˜Ÿ<br/>ä¸»ä»å¼]
    Workers --> W1[æŸ¥è¯¢Worker]
    Workers --> W2[æ›´æ–°Worker]
    
    style Router fill:#ff6b6b
    style Team fill:#51cf66
    style Search fill:#ffd43b
    style Workers fill:#a855f7
```

### æ ¸å¿ƒä»£ç 

```java
public class CustomerServiceSystem {
    private RouterAgent router;              // é›†ä¸­å¼è·¯ç”±
    private PeerAgentGroup expertTeam;       // å¯¹ç­‰å¼ä¸“å®¶å›¢é˜Ÿ
    private MasterWorkerGroup actionTeam;    // ä¸»ä»å¼æ‰§è¡Œå›¢é˜Ÿ
    
    public Response handleCustomerQuery(CustomerQuery query) {
        // 1. è·¯ç”±åˆ°åˆé€‚çš„å¤„ç†é“¾è·¯
        ProcessingChain chain = router.route(query);
        
        // 2. ä¸“å®¶å›¢é˜Ÿåå•†æœ€ä½³æ–¹æ¡ˆ
        Solution solution = expertTeam.consultAndDecide(query);
        
        // 3. æ‰§è¡Œå›¢é˜Ÿå¹¶è¡Œå¤„ç†
        Result result = actionTeam.executeInParallel(solution);
        
        return buildResponse(result);
    }
}
```

---

## æœ¬èŠ‚å°ç»“

### å…³é”®è¦ç‚¹å›é¡¾

1. **åä½œæ¨¡å¼æœ¬è´¨**ï¼šé€‰æ‹©åˆé€‚çš„ç»„ç»‡æ–¹å¼,è®©æ™ºèƒ½ä½“é«˜æ•ˆåä½œ
2. **æ²¡æœ‰é“¶å¼¹**ï¼šæ¯ç§æ¨¡å¼éƒ½æœ‰é€‚ç”¨åœºæ™¯,éœ€è¦æƒè¡¡å–èˆ
3. **å¯ç»„åˆæ€§**ï¼šå®é™…ç³»ç»Ÿå¾€å¾€æ··åˆä½¿ç”¨å¤šç§æ¨¡å¼
4. **è®¾è®¡åŸåˆ™**ï¼š
   - ä½è€¦åˆï¼šæ™ºèƒ½ä½“ä¹‹é—´æ¾æ•£è¿æ¥
   - é«˜å†…èšï¼šæ¯ä¸ªæ™ºèƒ½ä½“èŒè´£å•ä¸€
   - å¯æ‰©å±•ï¼šæ˜“äºæ·»åŠ æ–°çš„æ™ºèƒ½ä½“
   - å¯ç›‘æ§ï¼šèƒ½è¿½è¸ªç³»ç»Ÿè¿è¡ŒçŠ¶æ€

### å­¦ä¹ æ£€æŸ¥æ¸…å•

- [ ] èƒ½è§£é‡Šæ¯ç§åä½œæ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³
- [ ] èƒ½åˆ†æä¸åŒæ¨¡å¼çš„ä¼˜ç¼ºç‚¹
- [ ] èƒ½æ ¹æ®åœºæ™¯é€‰æ‹©åˆé€‚çš„æ¨¡å¼
- [ ] èƒ½å®ç°åŸºæœ¬çš„æ™ºèƒ½ä½“åä½œç³»ç»Ÿ
- [ ] ç†è§£æ¶ˆæ¯ä¼ é€’çš„é‡è¦æ€§

### è¿›é˜¶é˜…è¯»

- ã€ŠMulti-Agent Systemsã€‹- Wooldridge
- ã€ŠDistributed Systemsã€‹- Tanenbaum
- TinyAIæºç ï¼š`tinyai-agent-multi`æ¨¡å—

---

**ä¸‹ä¸€èŠ‚é¢„å‘Š**ï¼š18.2 AIç¼–ç¨‹åŠ©æ‰‹ - æˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªå®é™…çš„Cursoré£æ ¼ç¼–ç¨‹åŠ©æ‰‹,åº”ç”¨æœ¬èŠ‚å­¦åˆ°çš„åä½œæ¨¡å¼ã€‚

