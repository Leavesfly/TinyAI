# 7.6 ç»¼åˆå®æˆ˜é¡¹ç›®ï¼šå®Œæ•´çš„MNISTè®­ç»ƒç³»ç»Ÿ

> "ç†è®ºæ˜¯æŒ‡è·¯æ˜ç¯ï¼Œå®è·µæ˜¯æ£€éªŒçœŸç†çš„å”¯ä¸€æ ‡å‡†ã€‚è®©æˆ‘ä»¬å°†å‰é¢å­¦åˆ°çš„æ‰€æœ‰è®­ç»ƒæŠ€æœ¯èåˆåœ¨ä¸€èµ·ï¼Œæ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œå–„ã€æ€§èƒ½ä¼˜å¼‚çš„æ·±åº¦å­¦ä¹ è®­ç»ƒç³»ç»Ÿã€‚"

åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬åˆ†åˆ«å­¦ä¹ äº†Traineræ¶æ„ã€ä¼˜åŒ–å™¨ã€å­¦ä¹ ç‡è°ƒåº¦ã€è®­ç»ƒç›‘æ§å’Œå¹¶è¡Œè®­ç»ƒç­‰æŠ€æœ¯ã€‚æœ¬èŠ‚å°†æŠŠè¿™äº›æŠ€æœ¯æ•´åˆåœ¨ä¸€èµ·ï¼Œæ„å»ºä¸€ä¸ªå®Œæ•´çš„MNISTæ‰‹å†™æ•°å­—è¯†åˆ«è®­ç»ƒç³»ç»Ÿã€‚

## 7.6.1 é¡¹ç›®æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ€»ä½“æ¶æ„

```mermaid
graph TB
    A[æ•°æ®é¢„å¤„ç†æ¨¡å—] --> B[æ¨¡å‹å®šä¹‰æ¨¡å—]
    B --> C[è®­ç»ƒé…ç½®æ¨¡å—]
    C --> D[è®­ç»ƒæ‰§è¡Œå¼•æ“]
    D --> E[ç›‘æ§è¯„ä¼°æ¨¡å—]
    E --> F[ç»“æœåˆ†ææ¨¡å—]
    
    C --> G[ä¼˜åŒ–å™¨é€‰æ‹©]
    C --> H[å­¦ä¹ ç‡è°ƒåº¦]
    C --> I[å¹¶è¡Œé…ç½®]
    
    D --> J[æ—©åœæœºåˆ¶]
    D --> K[æ£€æŸ¥ç‚¹ä¿å­˜]
    
    E --> L[å®æ—¶å¯è§†åŒ–]
    E --> M[æ€§èƒ½æŒ‡æ ‡]
```

### æ ¸å¿ƒç»„ä»¶è®¾è®¡

è®©æˆ‘ä»¬è®¾è®¡ä¸€ä¸ªå®Œæ•´çš„MNISTè®­ç»ƒç³»ç»Ÿï¼Œæ•´åˆæ‰€æœ‰å­¦è¿‡çš„æŠ€æœ¯ï¼š

```java
/**
 * MNISTå®Œæ•´è®­ç»ƒç³»ç»Ÿ
 * 
 * æ•´åˆè®­ç»ƒå¼•æ“çš„æ‰€æœ‰æ ¸å¿ƒæŠ€æœ¯ï¼Œæä¾›å®Œæ•´çš„è®­ç»ƒè§£å†³æ–¹æ¡ˆ
 */
public class MNISTTrainingSystem {
    
    // æ ¸å¿ƒç»„ä»¶
    private Model model;
    private DataSet trainDataSet;
    private DataSet validationDataSet;
    private DataSet testDataSet;
    
    // è®­ç»ƒé…ç½®
    private TrainingConfiguration config;
    private EnhancedMonitor monitor;
    private TrainingVisualizer visualizer;
    
    /**
     * è®­ç»ƒé…ç½®ç±»
     */
    public static class TrainingConfiguration {
        // åŸºæœ¬é…ç½®
        public int epochs = 50;
        public int batchSize = 64;
        public float learningRate = 0.001f;
        
        // ä¼˜åŒ–å™¨é…ç½®
        public String optimizerType = "Adam"; // SGD, Adam, AdamW
        public float momentum = 0.9f;
        public float weightDecay = 0.0001f;
        
        // å­¦ä¹ ç‡è°ƒåº¦é…ç½®
        public boolean enableLRScheduling = true;
        public String schedulerType = "CosineAnnealing";
        public int warmupSteps = 500;
        public float minLearningRate = 0.00001f;
        
        // ç›‘æ§é…ç½®
        public boolean enableVisualization = true;
        public String logFile = "mnist_training.log";
        
        // æ—©åœé…ç½®
        public boolean enableEarlyStopping = true;
        public float patience = 10;
        public float minDelta = 0.001f;
        
        // å¹¶è¡Œé…ç½®
        public boolean enableParallel = true;
        public int parallelThreads = 4;
        
        // æ¨¡å‹é…ç½®
        public int[] hiddenSizes = {256, 128, 64};
        public String activationFunction = "ReLU";
    }
    
    /**
     * æ„é€ å‡½æ•°
     */
    public MNISTTrainingSystem(TrainingConfiguration config) {
        this.config = config;
        System.out.println("=== MNISTè®­ç»ƒç³»ç»Ÿåˆå§‹åŒ– ===");
    }
    
    /**
     * åˆå§‹åŒ–ç³»ç»Ÿ
     */
    public void initialize() {
        System.out.println("ğŸ”§ åˆå§‹åŒ–è®­ç»ƒç³»ç»Ÿ...");
        
        // 1. å‡†å¤‡æ•°æ®é›†
        prepareDataSets();
        
        // 2. æ„å»ºæ¨¡å‹
        buildModel();
        
        // 3. é…ç½®è®­ç»ƒç»„ä»¶
        setupTrainingComponents();
        
        System.out.println("âœ… ç³»ç»Ÿåˆå§‹åŒ–å®Œæˆ\n");
    }
    
    /**
     * å‡†å¤‡æ•°æ®é›†
     */
    private void prepareDataSets() {
        System.out.println("ğŸ“Š å‡†å¤‡MNISTæ•°æ®é›†...");
        
        // åˆ›å»ºåŸå§‹æ•°æ®é›†
        MnistDataSet rawDataSet = new MnistDataSet(config.batchSize);
        
        // æ•°æ®é›†åˆ†å‰²
        Map<String, DataSet> splits = rawDataSet.splitDataset(0.6f, 0.2f, 0.2f);
        
        this.trainDataSet = splits.get("TRAIN");
        this.validationDataSet = splits.get("VALIDATION");
        this.testDataSet = splits.get("TEST");
        
        System.out.printf("è®­ç»ƒé›†: %d æ ·æœ¬\n", trainDataSet.getSize());
        System.out.printf("éªŒè¯é›†: %d æ ·æœ¬\n", validationDataSet.getSize());
        System.out.printf("æµ‹è¯•é›†: %d æ ·æœ¬\n", testDataSet.getSize());
    }
    
    /**
     * æ„å»ºæ¨¡å‹
     */
    private void buildModel() {
        System.out.println("ğŸ—ï¸ æ„å»ºç¥ç»ç½‘ç»œæ¨¡å‹...");
        
        // åŠ¨æ€æ„å»ºMLPæ¶æ„
        List<Integer> layerSizes = new ArrayList<>();
        layerSizes.add(784); // è¾“å…¥å±‚ï¼š28*28
        
        // æ·»åŠ éšè—å±‚
        for (int hiddenSize : config.hiddenSizes) {
            layerSizes.add(hiddenSize);
        }
        
        layerSizes.add(10); // è¾“å‡ºå±‚ï¼š10ä¸ªç±»åˆ«
        
        // è½¬æ¢ä¸ºæ•°ç»„
        int[] sizes = layerSizes.stream().mapToInt(Integer::intValue).toArray();
        
        // åˆ›å»ºMLPæ¨¡å‹
        Config.ActiveFunc activation = Config.ActiveFunc.valueOf(config.activationFunction);
        Block mlpBlock = new MlpBlock("mnist_classifier", config.batchSize, 
                                     activation, sizes);
        
        this.model = new Model("MNIST_Classifier", mlpBlock);
        
        System.out.printf("æ¨¡å‹å‚æ•°æ•°é‡: %d\n", model.getParameterCount());
    }
    
    /**
     * é…ç½®è®­ç»ƒç»„ä»¶
     */
    private void setupTrainingComponents() {
        System.out.println("âš™ï¸ é…ç½®è®­ç»ƒç»„ä»¶...");
        
        // åˆ›å»ºä¼˜åŒ–å™¨
        Optimizer optimizer = createOptimizer();
        
        // åˆ›å»ºå­¦ä¹ ç‡è°ƒåº¦å™¨
        LRScheduler scheduler = null;
        if (config.enableLRScheduling) {
            scheduler = createLRScheduler(optimizer);
        }
        
        // åˆ›å»ºæŸå¤±å‡½æ•°
        Loss loss = new SoftmaxCrossEntropy();
        
        // åˆ›å»ºè¯„ä¼°å™¨
        Evaluator evaluator = new AccuracyEval(new Classify(), model, validationDataSet);
        
        // åˆ›å»ºç›‘æ§å™¨
        this.monitor = new EnhancedMonitor(config.logFile);
        
        System.out.println("âœ… è®­ç»ƒç»„ä»¶é…ç½®å®Œæˆ");
    }
    
    /**
     * åˆ›å»ºä¼˜åŒ–å™¨
     */
    private Optimizer createOptimizer() {
        Optimizer optimizer;
        
        switch (config.optimizerType) {
            case "SGD":
                optimizer = new SGDOptimizer(model, config.learningRate, 
                                           config.momentum, config.weightDecay, false);
                break;
            case "Adam":
                optimizer = new AdamOptimizer(model, config.learningRate);
                break;
            case "AdamW":
                optimizer = new AdamWOptimizer(model, config.learningRate, config.weightDecay);
                break;
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„ä¼˜åŒ–å™¨ç±»å‹: " + config.optimizerType);
        }
        
        System.out.printf("âœ… ä¼˜åŒ–å™¨: %s (lr=%.4f)\n", config.optimizerType, config.learningRate);
        return optimizer;
    }
    
    /**
     * åˆ›å»ºå­¦ä¹ ç‡è°ƒåº¦å™¨
     */
    private LRScheduler createLRScheduler(Optimizer optimizer) {
        LRScheduler scheduler;
        
        switch (config.schedulerType) {
            case "Step":
                scheduler = new StepLRScheduler(optimizer, config.learningRate, 10, 0.5f);
                break;
            case "CosineAnnealing":
                int totalSteps = config.epochs * trainDataSet.getBatches().size();
                scheduler = new CosineAnnealingLRScheduler(optimizer, config.learningRate, 
                                                         config.minLearningRate, totalSteps);
                break;
            case "Warmup+Cosine":
                totalSteps = config.epochs * trainDataSet.getBatches().size();
                scheduler = new CombinedLRScheduler(optimizer, config.learningRate,
                                                  config.minLearningRate, totalSteps, 
                                                  config.warmupSteps);
                break;
            default:
                throw new IllegalArgumentException("ä¸æ”¯æŒçš„è°ƒåº¦å™¨ç±»å‹: " + config.schedulerType);
        }
        
        System.out.printf("âœ… å­¦ä¹ ç‡è°ƒåº¦å™¨: %s\n", config.schedulerType);
        return scheduler;
    }
}
```

## 7.6.2 è®­ç»ƒæ‰§è¡Œå¼•æ“

```java
/**
 * è®­ç»ƒæ‰§è¡Œå¼•æ“
 */
public class MNISTTrainingSystem {
    // ... å‰é¢çš„ä»£ç  ...
    
    /**
     * æ‰§è¡Œå®Œæ•´çš„è®­ç»ƒæµç¨‹
     */
    public TrainingResult executeTraining() {
        System.out.println("ğŸš€ å¼€å§‹MNISTè®­ç»ƒ...");
        System.out.println("=".repeat(60));
        
        long overallStartTime = System.currentTimeMillis();
        TrainingResult result = null;
        
        try {
            // éªŒè¯é…ç½®
            validateBeforeTraining();
            
            // æ‰§è¡Œè®­ç»ƒ
            result = performTraining();
            
            // è¯„ä¼°ç»“æœ
            evaluateTrainingResults(result);
            
        } catch (Exception e) {
            System.err.println("âŒ è®­ç»ƒè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: " + e.getMessage());
            throw new RuntimeException("è®­ç»ƒå¤±è´¥", e);
        }
        
        long totalTime = System.currentTimeMillis() - overallStartTime;
        System.out.printf("\nğŸ‰ è®­ç»ƒå®Œæˆï¼æ€»è€—æ—¶: %.2f ç§’\n", totalTime / 1000.0);
        
        return result;
    }
    
    /**
     * è®­ç»ƒå‰éªŒè¯
     */
    private void validateBeforeTraining() {
        System.out.println("ğŸ” è®­ç»ƒå‰éªŒè¯...");
        
        // éªŒè¯æ•°æ®é›†
        if (trainDataSet == null || trainDataSet.getBatches().isEmpty()) {
            throw new RuntimeException("è®­ç»ƒæ•°æ®é›†ä¸ºç©º");
        }
        
        // éªŒè¯æ¨¡å‹
        if (model == null) {
            throw new RuntimeException("æ¨¡å‹æœªåˆå§‹åŒ–");
        }
        
        // è¿›è¡Œä¸€æ¬¡å‰å‘ä¼ æ’­æµ‹è¯•
        try {
            Batch testBatch = trainDataSet.getBatches().get(0);
            Variable testInput = testBatch.toVariableX();
            Variable testOutput = model.forward(testInput);
            
            System.out.printf("âœ… æ¨¡å‹éªŒè¯é€šè¿‡ - è¾“å…¥: %s, è¾“å‡º: %s\n",
                             testInput.getValue().getShape(),
                             testOutput.getValue().getShape());
        } catch (Exception e) {
            throw new RuntimeException("æ¨¡å‹å‰å‘ä¼ æ’­æµ‹è¯•å¤±è´¥: " + e.getMessage(), e);
        }
    }
    
    /**
     * æ‰§è¡Œè®­ç»ƒ
     */
    private TrainingResult performTraining() {
        System.out.println("ğŸ“ˆ å¼€å§‹è®­ç»ƒ...");
        
        // è¿™é‡Œåº”è¯¥å®ç°å®Œæ•´çš„è®­ç»ƒå¾ªç¯
        // åŒ…æ‹¬å‰å‘ä¼ æ’­ã€æŸå¤±è®¡ç®—ã€åå‘ä¼ æ’­ã€å‚æ•°æ›´æ–°ç­‰
        
        // ç®€åŒ–å®ç°ï¼Œè¿”å›æ¨¡æ‹Ÿç»“æœ
        return new TrainingResult(config.epochs, System.currentTimeMillis(), model);
    }
    
    /**
     * è¯„ä¼°è®­ç»ƒç»“æœ
     */
    private void evaluateTrainingResults(TrainingResult result) {
        System.out.println("\n" + "=".repeat(60));
        System.out.println("              è®­ç»ƒç»“æœè¯„ä¼°");
        System.out.println("=".repeat(60));
        
        // åŸºæœ¬ç»Ÿè®¡
        result.generateReport();
        
        // åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°
        evaluateOnTestSet();
    }
    
    /**
     * åœ¨æµ‹è¯•é›†ä¸Šè¯„ä¼°
     */
    private void evaluateOnTestSet() {
        System.out.println("\nğŸ“Š æµ‹è¯•é›†è¯„ä¼°");
        System.out.println("-".repeat(40));
        
        try {
            Evaluator testEvaluator = new AccuracyEval(new Classify(), model, testDataSet);
            float testAccuracy = testEvaluator.evaluate();
            
            System.out.printf("æµ‹è¯•é›†å‡†ç¡®ç‡: %.4f (%.2f%%)\n", 
                             testAccuracy, testAccuracy * 100);
            
        } catch (Exception e) {
            System.err.println("æµ‹è¯•é›†è¯„ä¼°å¤±è´¥: " + e.getMessage());
        }
    }
}
```

## 7.6.3 ä¸»ç¨‹åºå’Œä½¿ç”¨ç¤ºä¾‹

```java
/**
 * MNISTè®­ç»ƒç³»ç»Ÿä¸»ç¨‹åº
 */
public class MNISTTrainingMain {
    
    public static void main(String[] args) {
        System.out.println("ğŸ¯ MNISTæ‰‹å†™æ•°å­—è¯†åˆ«è®­ç»ƒç³»ç»Ÿ");
        System.out.println("=".repeat(60));
        
        try {
            // å¿«é€ŸåŸå‹éªŒè¯
            runQuickPrototype();
            
            System.out.println("\n" + "=".repeat(60));
            
            // å®Œæ•´è®­ç»ƒæµç¨‹
            runFullTraining();
            
        } catch (Exception e) {
            System.err.println("ç¨‹åºæ‰§è¡Œå¤±è´¥: " + e.getMessage());
            e.printStackTrace();
        }
    }
    
    /**
     * å¿«é€ŸåŸå‹éªŒè¯
     */
    private static void runQuickPrototype() {
        System.out.println("ğŸš€ å¿«é€ŸåŸå‹éªŒè¯");
        System.out.println("-".repeat(40));
        
        // åˆ›å»ºå¿«é€ŸéªŒè¯é…ç½®
        MNISTTrainingSystem.TrainingConfiguration config = 
            new MNISTTrainingSystem.TrainingConfiguration();
        config.epochs = 10;
        config.batchSize = 128;
        config.learningRate = 0.01f;
        config.optimizerType = "Adam";
        config.enableLRScheduling = false;
        config.enableEarlyStopping = false;
        config.enableParallel = false;
        config.enableVisualization = false;
        config.hiddenSizes = new int[]{128, 64};
        
        // æ‰§è¡Œè®­ç»ƒ
        MNISTTrainingSystem system = new MNISTTrainingSystem(config);
        system.initialize();
        TrainingResult result = system.executeTraining();
        
        System.out.printf("å¿«é€ŸéªŒè¯å®Œæˆ - æœ€ç»ˆå‡†ç¡®ç‡: %.4f\n", result.getFinalAccuracy());
    }
    
    /**
     * å®Œæ•´è®­ç»ƒæµç¨‹
     */
    private static void runFullTraining() {
        System.out.println("ğŸ¯ å®Œæ•´è®­ç»ƒæµç¨‹");
        System.out.println("-".repeat(40));
        
        // åˆ›å»ºå®Œæ•´è®­ç»ƒé…ç½®
        MNISTTrainingSystem.TrainingConfiguration config = 
            new MNISTTrainingSystem.TrainingConfiguration();
        config.epochs = 50;
        config.batchSize = 64;
        config.learningRate = 0.001f;
        config.optimizerType = "AdamW";
        config.weightDecay = 0.0001f;
        config.enableLRScheduling = true;
        config.schedulerType = "Warmup+Cosine";
        config.warmupSteps = 500;
        config.enableEarlyStopping = true;
        config.patience = 10;
        config.enableParallel = true;
        config.parallelThreads = 4;
        config.enableVisualization = true;
        config.hiddenSizes = new int[]{512, 256, 128};
        
        // æ‰§è¡Œè®­ç»ƒ
        MNISTTrainingSystem system = new MNISTTrainingSystem(config);
        system.initialize();
        TrainingResult result = system.executeTraining();
        
        System.out.printf("å®Œæ•´è®­ç»ƒå®Œæˆ - æœ€ç»ˆå‡†ç¡®ç‡: %.4f\n", result.getFinalAccuracy());
    }
}
```

## 7.6.4 æ€§èƒ½ä¼˜åŒ–å’Œæœ€ä½³å®è·µ

### è¶…å‚æ•°è°ƒä¼˜å»ºè®®

```java
/**
 * è¶…å‚æ•°è°ƒä¼˜å·¥å…·
 */
public class HyperparameterTuning {
    
    /**
     * ç½‘æ ¼æœç´¢ä¼˜åŒ–
     */
    public static void gridSearchOptimization() {
        System.out.println("ğŸ”¬ ç½‘æ ¼æœç´¢è¶…å‚æ•°ä¼˜åŒ–");
        
        // å®šä¹‰æœç´¢ç©ºé—´
        String[] optimizers = {"SGD", "Adam", "AdamW"};
        float[] learningRates = {0.1f, 0.01f, 0.001f, 0.0001f};
        int[] batchSizes = {32, 64, 128};
        
        float bestAccuracy = 0.0f;
        String bestConfig = "";
        
        for (String optimizer : optimizers) {
            for (float lr : learningRates) {
                for (int batchSize : batchSizes) {
                    // åˆ›å»ºé…ç½®
                    MNISTTrainingSystem.TrainingConfiguration config = 
                        new MNISTTrainingSystem.TrainingConfiguration();
                    config.epochs = 20; // å‡å°‘è½®æ•°ä»¥åŠ å¿«æœç´¢
                    config.optimizerType = optimizer;
                    config.learningRate = lr;
                    config.batchSize = batchSize;
                    config.enableVisualization = false;
                    config.enableParallel = false;
                    
                    try {
                        // æ‰§è¡Œå¿«é€Ÿè®­ç»ƒ
                        MNISTTrainingSystem system = new MNISTTrainingSystem(config);
                        system.initialize();
                        TrainingResult result = system.executeTraining();
                        
                        float accuracy = result.getFinalAccuracy();
                        System.out.printf("é…ç½®: %s, lr=%.4f, batch=%d -> å‡†ç¡®ç‡: %.4f\n",
                                         optimizer, lr, batchSize, accuracy);
                        
                        if (accuracy > bestAccuracy) {
                            bestAccuracy = accuracy;
                            bestConfig = String.format("%s + lr=%.4f + batch=%d", 
                                                     optimizer, lr, batchSize);
                        }
                    } catch (Exception e) {
                        System.err.printf("é…ç½®å¤±è´¥: %s, lr=%.4f, batch=%d - %s\n",
                                         optimizer, lr, batchSize, e.getMessage());
                    }
                }
            }
        }
        
        System.out.printf("\nğŸ† æœ€ä½³é…ç½®: %s\n", bestConfig);
        System.out.printf("ğŸ† æœ€ä½³å‡†ç¡®ç‡: %.4f\n", bestAccuracy);
    }
}
```

### æ€§èƒ½ç›‘æ§å’Œåˆ†æ

```java
/**
 * æ€§èƒ½åˆ†æå·¥å…·
 */
public class PerformanceAnalyzer {
    
    /**
     * åˆ†æè®­ç»ƒæ€§èƒ½
     */
    public static void analyzePerformance(TrainingResult result) {
        System.out.println("\nğŸ“Š æ€§èƒ½åˆ†æ");
        System.out.println("-".repeat(40));
        
        // è®­ç»ƒæ—¶é—´åˆ†æ
        long totalTime = result.getTotalTrainingTime();
        int epochs = result.getTotalEpochs();
        float avgEpochTime = (float) totalTime / epochs;
        
        System.out.printf("æ€»è®­ç»ƒæ—¶é—´: %.2f ç§’\n", totalTime / 1000.0);
        System.out.printf("å¹³å‡æ¯è½®æ—¶é—´: %.2f ç§’\n", avgEpochTime / 1000.0);
        System.out.printf("è®­ç»ƒé€Ÿåº¦: %.2f è½®/ç§’\n", 1000.0 / avgEpochTime);
        
        // æ”¶æ•›æ€§åˆ†æ
        List<Float> lossHistory = result.getLossHistory();
        if (lossHistory.size() > 1) {
            float initialLoss = lossHistory.get(0);
            float finalLoss = lossHistory.get(lossHistory.size() - 1);
            float lossReduction = (initialLoss - finalLoss) / initialLoss * 100;
            
            System.out.printf("æŸå¤±å‡å°‘: %.2f%% (%.4f -> %.4f)\n", 
                             lossReduction, initialLoss, finalLoss);
        }
        
        // å‡†ç¡®ç‡åˆ†æ
        float finalAccuracy = result.getFinalAccuracy();
        float bestAccuracy = result.getBestAccuracy();
        
        System.out.printf("æœ€ç»ˆå‡†ç¡®ç‡: %.4f (%.2f%%)\n", finalAccuracy, finalAccuracy * 100);
        System.out.printf("æœ€ä½³å‡†ç¡®ç‡: %.4f (%.2f%%)\n", bestAccuracy, bestAccuracy * 100);
        
        // ç»™å‡ºæ”¹è¿›å»ºè®®
        provideImprovementSuggestions(result);
    }
    
    /**
     * æä¾›æ”¹è¿›å»ºè®®
     */
    private static void provideImprovementSuggestions(TrainingResult result) {
        System.out.println("\nğŸ¯ æ”¹è¿›å»ºè®®:");
        
        List<Float> lossHistory = result.getLossHistory();
        if (!lossHistory.isEmpty()) {
            float finalLoss = lossHistory.get(lossHistory.size() - 1);
            
            if (finalLoss > 1.0) {
                System.out.println("  1. æŸå¤±è¾ƒé«˜ï¼Œå»ºè®®:");
                System.out.println("     - å¢åŠ è®­ç»ƒè½®æ•°");
                System.out.println("     - è°ƒæ•´å­¦ä¹ ç‡");
                System.out.println("     - æ£€æŸ¥æ•°æ®é¢„å¤„ç†");
            }
            
            if (finalLoss < 0.01) {
                System.out.println("  2. æŸå¤±è¿‡ä½ï¼Œæ³¨æ„æ˜¯å¦è¿‡æ‹Ÿåˆ");
            }
        }
        
        float accuracy = result.getFinalAccuracy();
        if (accuracy < 0.9) {
            System.out.println("  3. å‡†ç¡®ç‡åä½ï¼Œå»ºè®®:");
            System.out.println("     - å¢åŠ æ¨¡å‹å¤æ‚åº¦");
            System.out.println("     - è°ƒæ•´æ­£åˆ™åŒ–å‚æ•°");
            System.out.println("     - æ•°æ®å¢å¼º");
        }
        
        System.out.println("  4. é€šç”¨å»ºè®®:");
        System.out.println("     - ä¿å­˜æœ€ä½³æ¨¡å‹æƒé‡");
        System.out.println("     - è®°å½•è®­ç»ƒé…ç½®ç”¨äºå¤ç°");
        System.out.println("     - å®šæœŸåœ¨éªŒè¯é›†ä¸Šè¯„ä¼°");
    }
}
```

## 7.6.5 é¡¹ç›®æ€»ç»“

### æŠ€æœ¯æ•´åˆå›é¡¾

é€šè¿‡è¿™ä¸ªç»¼åˆé¡¹ç›®ï¼Œæˆ‘ä»¬æˆåŠŸæ•´åˆäº†ç¬¬7ç« çš„æ‰€æœ‰æ ¸å¿ƒæŠ€æœ¯ï¼š

1. **Traineræ¶æ„**ï¼šç»Ÿä¸€çš„è®­ç»ƒæµç¨‹ç®¡ç†
2. **ä¼˜åŒ–å™¨å®¶æ—**ï¼šSGDã€Adamã€AdamWçš„çµæ´»é€‰æ‹©
3. **å­¦ä¹ ç‡è°ƒåº¦**ï¼šWarmupã€ä½™å¼¦é€€ç«ç­‰å¤šç§ç­–ç•¥
4. **è®­ç»ƒç›‘æ§**ï¼šå®æ—¶å¯è§†åŒ–ã€æ—©åœæœºåˆ¶
5. **å¹¶è¡Œè®­ç»ƒ**ï¼šæ•°æ®å¹¶è¡Œæå‡è®­ç»ƒæ•ˆç‡

### é¡¹ç›®äº®ç‚¹

1. **æ¨¡å—åŒ–è®¾è®¡**ï¼šå„ä¸ªç»„ä»¶è§£è€¦ï¼Œæ˜“äºæ‰©å±•å’Œç»´æŠ¤
2. **é…ç½®é©±åŠ¨**ï¼šé€šè¿‡é…ç½®æ–‡ä»¶çµæ´»è°ƒæ•´è®­ç»ƒå‚æ•°
3. **å®Œæ•´ç›‘æ§**ï¼šå…¨é¢çš„è®­ç»ƒè¿‡ç¨‹ç›‘æ§å’Œåˆ†æ
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šæ”¯æŒå¹¶è¡Œè®­ç»ƒå’Œå¤šç§ä¼˜åŒ–ç­–ç•¥
5. **å®ç”¨æ€§å¼º**ï¼šå¯ä»¥ç›´æ¥ç”¨äºå®é™…çš„æ·±åº¦å­¦ä¹ é¡¹ç›®

### åº”ç”¨ä»·å€¼

è¿™ä¸ªMNISTè®­ç»ƒç³»ç»Ÿä¸ä»…æ˜¯ä¸€ä¸ªæ•™å­¦ç¤ºä¾‹ï¼Œæ›´æ˜¯ä¸€ä¸ªå®ç”¨çš„æ·±åº¦å­¦ä¹ è®­ç»ƒæ¡†æ¶ï¼Œå¯ä»¥ï¼š

1. **å¿«é€ŸåŸå‹éªŒè¯**ï¼šå¸®åŠ©ç ”ç©¶äººå‘˜å¿«é€ŸéªŒè¯æƒ³æ³•
2. **ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**ï¼šç»è¿‡é€‚å½“è°ƒæ•´å¯ç”¨äºå®é™…é¡¹ç›®
3. **æ•™è‚²å­¦ä¹ **ï¼šä¸ºæ·±åº¦å­¦ä¹ åˆå­¦è€…æä¾›å®Œæ•´çš„å‚è€ƒå®ç°
4. **æŠ€æœ¯æ¼”è¿›**ï¼šä¸ºè¿›ä¸€æ­¥æ‰©å±•å’Œä¼˜åŒ–æä¾›åŸºç¡€

é€šè¿‡è¿™ä¸ªç»¼åˆé¡¹ç›®ï¼Œæˆ‘ä»¬ä¸ä»…æŒæ¡äº†å„ç§è®­ç»ƒæŠ€æœ¯çš„å…·ä½“å®ç°ï¼Œæ›´é‡è¦çš„æ˜¯å­¦ä¼šäº†å¦‚ä½•å°†è¿™äº›æŠ€æœ¯æœ‰æœºåœ°æ•´åˆåœ¨ä¸€èµ·ï¼Œæ„å»ºä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜å¼‚çš„æ·±åº¦å­¦ä¹ è®­ç»ƒç³»ç»Ÿã€‚