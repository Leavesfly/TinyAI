# GPT-1å¤è¯—è¯è®­ç»ƒæŒ‡å—

æœ¬æŒ‡å—è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨TinyAIæ¡†æ¶åœ¨GPT-1ç›®å½•ä¸‹å®Œæˆå¤è¯—è¯è¯­è¨€æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹ã€‚

## ğŸ“ æ–‡ä»¶ç»“æ„

```
tinyai-model-gpt/src/main/java/io/leavesfly/tinyai/gpt1/
â”œâ”€â”€ ci.txt                        # å¤è¯—è¯è®­ç»ƒæ•°æ®
â”œâ”€â”€ ChineseTokenizer.java         # ä¸­æ–‡åˆ†è¯å™¨
â”œâ”€â”€ ChinesePoemDataSet.java       # å¤è¯—è¯æ•°æ®é›†ç±»
â”œâ”€â”€ GPT1PoemTrainer.java          # GPT-1å¤è¯—è¯è®­ç»ƒå™¨
â”œâ”€â”€ GPT1PoemTrainingDemo.java     # å®Œæ•´è®­ç»ƒæ¼”ç¤ºç¨‹åº
â”œâ”€â”€ README_å¤è¯—è¯è®­ç»ƒ.md           # æœ¬æ–‡æ¡£
â””â”€â”€ [å…¶ä»–GPT-1ç›¸å…³æ–‡ä»¶...]
```

## ğŸ¯ è®­ç»ƒç›®æ ‡

ä½¿ç”¨ç»å…¸å¤è¯—è¯æ•°æ®è®­ç»ƒä¸€ä¸ªèƒ½å¤Ÿç”Ÿæˆä¸­æ–‡å¤è¯—çš„GPT-1è¯­è¨€æ¨¡å‹ï¼Œæ”¯æŒï¼š

- åŸºäºæç¤ºè¯ç”Ÿæˆå¤è¯—ç»­å†™
- ä¸åŒé£æ ¼å’Œä¸»é¢˜çš„è¯—æ­Œåˆ›ä½œ
- å¯æ§çš„æ–‡æœ¬ç”Ÿæˆï¼ˆæ¸©åº¦å‚æ•°è°ƒèŠ‚ï¼‰
- æ¨¡å‹æ€§èƒ½è¯„ä¼°å’Œä¼˜åŒ–

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œå®Œæ•´æ¼”ç¤º

ç›´æ¥è¿è¡Œæ¼”ç¤ºç¨‹åºä½“éªŒå®Œæ•´çš„è®­ç»ƒæµç¨‹ï¼š

```bash
cd tinyai-model-gpt
java -cp target/classes io.leavesfly.tinyai.gpt1.GPT1PoemTrainingDemo
```

### 2. è‡ªå®šä¹‰è®­ç»ƒ

ä½¿ç”¨è®­ç»ƒå™¨ç±»è¿›è¡Œè‡ªå®šä¹‰è®­ç»ƒï¼š

```java
// åˆ›å»ºè®­ç»ƒé…ç½®
GPT1PoemTrainer.TrainingConfig config = new GPT1PoemTrainer.TrainingConfig();
config.epochs = 30;
config.batchSize = 4;
config.learningRate = 0.001;

// åˆ›å»ºè®­ç»ƒå™¨å¹¶è®­ç»ƒ
GPT1PoemTrainer trainer = new GPT1PoemTrainer(config);
trainer.initialize("src/main/java/io/leavesfly/tinyai/gpt1/ci.txt");
trainer.train();

// ç”Ÿæˆå¤è¯—
String poem = trainer.generateText("æ˜¥æ±Ÿ", 15, 0.8);
System.out.println("ç”Ÿæˆçš„è¯—å¥: " + poem);
```

## ğŸ“Š è®­ç»ƒæ•°æ®

### æ•°æ®æ ¼å¼

`ci.txt` æ–‡ä»¶åŒ…å«ç»å…¸å¤è¯—è¯ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š

```
æ˜¥æ±ŸèŠ±æœˆå¤œ
æ˜¥æ±Ÿæ½®æ°´è¿æµ·å¹³ï¼Œæµ·ä¸Šæ˜æœˆå…±æ½®ç”Ÿã€‚
æ»Ÿæ»Ÿéšæ³¢åƒä¸‡é‡Œï¼Œä½•å¤„æ˜¥æ±Ÿæ— æœˆæ˜ï¼
æ±Ÿæµå®›è½¬ç»•èŠ³ç”¸ï¼Œæœˆç…§èŠ±æ—çš†ä¼¼éœ°ã€‚

é™å¤œæ€
åºŠå‰æ˜æœˆå…‰ï¼Œç–‘æ˜¯åœ°ä¸Šéœœã€‚
ä¸¾å¤´æœ›æ˜æœˆï¼Œä½å¤´æ€æ•…ä¹¡ã€‚
```

### æ•°æ®é¢„å¤„ç†

1. **åˆ†è¯ç­–ç•¥**: é‡‡ç”¨å­—ç¬¦çº§åˆ†è¯ï¼Œé€‚åˆä¸­æ–‡å¤è¯—è¯çš„ç‰¹ç‚¹
2. **è¯æ±‡è¡¨æ„å»º**: è‡ªåŠ¨æå–æ‰€æœ‰å­—ç¬¦æ„å»ºè¯æ±‡è¡¨
3. **åºåˆ—å¤„ç†**: æ·»åŠ ç‰¹æ®Štokenï¼ˆBOS/EOS/PAD/UNKï¼‰
4. **æ•°æ®å¢å¼º**: åˆ›å»ºè¾“å…¥-ç›®æ ‡å¯¹ç”¨äºè¯­è¨€æ¨¡å‹è®­ç»ƒ

### æ•°æ®ç»Ÿè®¡

è®­ç»ƒå®Œæˆåä¼šæ˜¾ç¤ºæ•°æ®ç»Ÿè®¡ä¿¡æ¯ï¼š
- æ€»è¯æ±‡æ•°
- è®­ç»ƒåºåˆ—æ•°é‡
- å¹³å‡åºåˆ—é•¿åº¦
- é•¿åº¦åˆ†å¸ƒæƒ…å†µ

## ğŸ§  æ¨¡å‹æ¶æ„

### GPT-1é…ç½®

| å‚æ•° | æ¼”ç¤ºé…ç½® | å®Œæ•´é…ç½® | è¯´æ˜ |
|------|----------|----------|------|
| è¯æ±‡è¡¨å¤§å° | è‡ªé€‚åº” | è‡ªé€‚åº” | æ ¹æ®æ•°æ®è‡ªåŠ¨ç¡®å®š |
| æœ€å¤§åºåˆ—é•¿åº¦ | 32 | 64 | è¾“å…¥åºåˆ—æœ€å¤§é•¿åº¦ |
| éšè—å±‚ç»´åº¦ | 128 | 256 | Transformeréšè—å±‚å¤§å° |
| å±‚æ•° | 4 | 8 | Transformerå±‚æ•° |
| æ³¨æ„åŠ›å¤´æ•° | 4 | 8 | å¤šå¤´æ³¨æ„åŠ›å¤´æ•° |

### æ¨¡å‹ç»„ä»¶

1. **TokenåµŒå…¥å±‚**: å°†å­—ç¬¦è½¬æ¢ä¸ºå‘é‡è¡¨ç¤º
2. **ä½ç½®ç¼–ç **: ä¸ºåºåˆ—ä½ç½®æ·»åŠ ç¼–ç ä¿¡æ¯
3. **Transformerå±‚**: å¤šå±‚è‡ªæ³¨æ„åŠ›æœºåˆ¶
4. **è¾“å‡ºå±‚**: é¢„æµ‹ä¸‹ä¸€ä¸ªå­—ç¬¦çš„æ¦‚ç‡åˆ†å¸ƒ

## âš™ï¸ è®­ç»ƒé…ç½®

### åŸºç¡€å‚æ•°

```java
TrainingConfig config = new TrainingConfig();

// è®­ç»ƒå‚æ•°
config.epochs = 20;              // è®­ç»ƒè½®æ•°
config.batchSize = 4;            // æ‰¹é‡å¤§å°
config.learningRate = 0.001;     // å­¦ä¹ ç‡
config.validationRatio = 0.2;    // éªŒè¯é›†æ¯”ä¾‹

// ç”Ÿæˆå‚æ•°
config.generateLength = 15;      // ç”Ÿæˆæ–‡æœ¬é•¿åº¦
config.temperature = 0.8;        // ç”Ÿæˆéšæœºæ€§æ§åˆ¶
```

### é«˜çº§é…ç½®

- **ä¼˜åŒ–å™¨**: Adam (Î²1=0.9, Î²2=0.999, Îµ=1e-4)
- **æŸå¤±å‡½æ•°**: SoftmaxCrossEntropy
- **æ­£åˆ™åŒ–**: Dropout (å¯é…ç½®)
- **å­¦ä¹ ç‡è°ƒåº¦**: å›ºå®šå­¦ä¹ ç‡ï¼ˆå¯æ‰©å±•ï¼‰

## ğŸ“ˆ è®­ç»ƒè¿‡ç¨‹

### è®­ç»ƒæµç¨‹

1. **æ•°æ®åŠ è½½**: è¯»å–å¤è¯—è¯æ–‡ä»¶å¹¶åˆ†è¯
2. **è¯æ±‡è¡¨æ„å»º**: åˆ›å»ºå­—ç¬¦åˆ°IDçš„æ˜ å°„
3. **æ•°æ®åˆ†å‰²**: åˆ†ä¸ºè®­ç»ƒé›†å’ŒéªŒè¯é›†
4. **æ¨¡å‹åˆå§‹åŒ–**: åˆ›å»ºGPT-1æ¨¡å‹å’Œä¼˜åŒ–å™¨
5. **è®­ç»ƒå¾ªç¯**: 
   - å‰å‘ä¼ æ’­è®¡ç®—æŸå¤±
   - åå‘ä¼ æ’­æ›´æ–°å‚æ•°
   - å®šæœŸéªŒè¯å’Œç”Ÿæˆæ ·æœ¬
6. **æ¨¡å‹ä¿å­˜**: ä¿å­˜è®­ç»ƒå¥½çš„æ¨¡å‹

### è®­ç»ƒç›‘æ§

è®­ç»ƒè¿‡ç¨‹ä¸­ä¼šæ˜¾ç¤ºï¼š
- è®­ç»ƒæŸå¤±å’ŒéªŒè¯æŸå¤±
- ç”Ÿæˆçš„æ ·æœ¬æ–‡æœ¬
- è®­ç»ƒè¿›åº¦å’Œæ—¶é—´æ¶ˆè€—
- æ¨¡å‹å‚æ•°ç»Ÿè®¡

## ğŸ¨ æ–‡æœ¬ç”Ÿæˆ

### ç”Ÿæˆç¤ºä¾‹

```java
// ä¸åŒæç¤ºè¯ç”Ÿæˆ
trainer.generateText("æ˜¥", 12, 0.8);    // æ˜¥å¤©ä¸»é¢˜
trainer.generateText("æœˆ", 12, 0.8);    // æœˆäº®ä¸»é¢˜
trainer.generateText("å±±æ°´", 15, 0.8);  // å±±æ°´ä¸»é¢˜

// ä¸åŒæ¸©åº¦å‚æ•°
trainer.generateText("æ˜¥æ±Ÿ", 15, 0.3);  // æ›´ç¡®å®šæ€§
trainer.generateText("æ˜¥æ±Ÿ", 15, 1.2);  // æ›´éšæœºæ€§
```

### æ¸©åº¦å‚æ•°è¯´æ˜

- **0.1-0.5**: ç”Ÿæˆè¾ƒä¸ºç¡®å®šå’Œä¿å®ˆçš„æ–‡æœ¬
- **0.6-0.8**: å¹³è¡¡åˆ›æ–°æ€§å’Œåˆç†æ€§ï¼ˆæ¨èï¼‰
- **0.9-1.2**: æ›´å…·åˆ›é€ æ€§ä½†å¯èƒ½ä¸å¤Ÿè¿è´¯
- **>1.5**: é«˜åº¦éšæœºï¼Œå¯èƒ½äº§ç”Ÿä¸åˆç†æ–‡æœ¬

## ğŸ“Š æ¨¡å‹è¯„ä¼°

### è¯„ä¼°æŒ‡æ ‡

1. **è®­ç»ƒæŸå¤±**: æ¨¡å‹åœ¨è®­ç»ƒæ•°æ®ä¸Šçš„æ‹Ÿåˆç¨‹åº¦
2. **éªŒè¯æŸå¤±**: æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›
3. **å›°æƒ‘åº¦ (Perplexity)**: è¯­è¨€æ¨¡å‹è´¨é‡æŒ‡æ ‡
4. **ç”Ÿæˆè´¨é‡**: ä¸»è§‚è¯„ä¼°ç”Ÿæˆæ–‡æœ¬çš„åˆç†æ€§

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|----------|----------|
| è®­ç»ƒæŸå¤±é«˜ | æ¨¡å‹å®¹é‡ä¸è¶³ | å¢åŠ éšè—å±‚ç»´åº¦æˆ–å±‚æ•° |
| éªŒè¯æŸå¤±é«˜ | è¿‡æ‹Ÿåˆ | å¢åŠ Dropoutæˆ–å‡å°‘æ¨¡å‹å¤æ‚åº¦ |
| ç”Ÿæˆè´¨é‡å·® | è®­ç»ƒä¸å……åˆ† | å¢åŠ è®­ç»ƒè½®æ•°æˆ–è°ƒæ•´å­¦ä¹ ç‡ |
| ç”Ÿæˆé‡å¤ | æ¸©åº¦å‚æ•°ä½ | é€‚å½“æé«˜æ¸©åº¦å‚æ•° |

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **å†…å­˜ä¸è¶³**
   - å‡å°‘æ‰¹é‡å¤§å°
   - é™ä½åºåˆ—é•¿åº¦
   - å‡å°‘æ¨¡å‹å‚æ•°

2. **è®­ç»ƒé€Ÿåº¦æ…¢**
   - ä½¿ç”¨è¾ƒå°çš„æ¨¡å‹é…ç½®
   - å‡å°‘è®­ç»ƒæ•°æ®é‡
   - ä¼˜åŒ–æ‰¹é‡å¤§å°

3. **ç”Ÿæˆè´¨é‡ä¸ä½³**
   - å¢åŠ è®­ç»ƒè½®æ•°
   - æ”¹è¿›è®­ç»ƒæ•°æ®è´¨é‡
   - è°ƒæ•´æ¨¡å‹æ¶æ„å‚æ•°

### è°ƒè¯•å»ºè®®

- æ£€æŸ¥è®­ç»ƒæŸå¤±æ˜¯å¦æŒç»­ä¸‹é™
- è§‚å¯ŸéªŒè¯æŸå¤±é¿å…è¿‡æ‹Ÿåˆ
- å®šæœŸæŸ¥çœ‹ç”Ÿæˆæ ·æœ¬è´¨é‡
- ç›‘æ§æ¨¡å‹å‚æ•°æ¢¯åº¦

## ğŸ”® æ‰©å±•åŠŸèƒ½

### å¯èƒ½çš„æ”¹è¿›æ–¹å‘

1. **æ•°æ®å¢å¼º**:
   - æ·»åŠ æ›´å¤šå¤è¯—è¯æ•°æ®
   - æ•°æ®æ¸…æ´—å’Œè´¨é‡æå‡
   - å¤šæ ·åŒ–çš„æ–‡æœ¬é¢„å¤„ç†

2. **æ¨¡å‹ä¼˜åŒ–**:
   - å®ç°å­¦ä¹ ç‡è°ƒåº¦
   - æ·»åŠ æ›´å¤šæ­£åˆ™åŒ–æŠ€æœ¯
   - ä¼˜åŒ–æ³¨æ„åŠ›æœºåˆ¶

3. **ç”Ÿæˆæ§åˆ¶**:
   - ä¸»é¢˜æ§åˆ¶ç”Ÿæˆ
   - é•¿åº¦ç²¾ç¡®æ§åˆ¶
   - é£æ ¼è¿ç§»

4. **è¯„ä¼°å®Œå–„**:
   - è‡ªåŠ¨åŒ–è´¨é‡è¯„ä¼°
   - å¤šç»´åº¦æ€§èƒ½æŒ‡æ ‡
   - äººå·¥è¯„ä¼°æ¡†æ¶

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

### å®Œæ•´è®­ç»ƒç¤ºä¾‹

```java
public class PoemTrainingExample {
    public static void main(String[] args) throws Exception {
        // 1. åˆ›å»ºé…ç½®
        TrainingConfig config = new TrainingConfig();
        config.epochs = 25;
        config.batchSize = 4;
        config.learningRate = 0.0008;
        config.maxSequenceLength = 32;
        config.hiddenSize = 128;
        
        // 2. åˆ›å»ºè®­ç»ƒå™¨
        GPT1PoemTrainer trainer = new GPT1PoemTrainer(config);
        
        // 3. åˆå§‹åŒ–å’Œè®­ç»ƒ
        trainer.initialize("ci.txt");
        trainer.train();
        
        // 4. æµ‹è¯•ç”Ÿæˆ
        System.out.println("æ˜¥æ±Ÿ -> " + trainer.generateText("æ˜¥æ±Ÿ", 16, 0.8));
        System.out.println("æ˜æœˆ -> " + trainer.generateText("æ˜æœˆ", 16, 0.8));
        
        // 5. è¯„ä¼°å›°æƒ‘åº¦
        double ppl = trainer.evaluatePerplexity();
        System.out.println("å›°æƒ‘åº¦: " + ppl);
    }
}
```

## ğŸ“– å‚è€ƒèµ„æ–™

- GPT-1è®ºæ–‡: "Improving Language Understanding by Generative Pre-Training"
- TinyAIæ¡†æ¶æ–‡æ¡£
- Transformeræ¶æ„è¯¦è§£
- ä¸­æ–‡è‡ªç„¶è¯­è¨€å¤„ç†æœ€ä½³å®è·µ

---

**æ³¨æ„**: è¿™æ˜¯ä¸€ä¸ªæ•™è‚²æ€§è´¨çš„æ¼”ç¤ºé¡¹ç›®ï¼Œå®é™…çš„ç”Ÿäº§çº§è¯­è¨€æ¨¡å‹éœ€è¦æ›´å¤§è§„æ¨¡çš„æ•°æ®ã€æ›´å¤æ‚çš„æ¶æ„å’Œæ›´å¤šçš„è®¡ç®—èµ„æºã€‚æœ¬é¡¹ç›®æ—¨åœ¨å¸®åŠ©ç†è§£GPTæ¨¡å‹çš„åŸºæœ¬åŸç†å’Œè®­ç»ƒæµç¨‹ã€‚