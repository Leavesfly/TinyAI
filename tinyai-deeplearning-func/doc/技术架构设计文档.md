# TinyAIè‡ªåŠ¨å¾®åˆ†å¼•æ“æŠ€æœ¯æ¶æ„è®¾è®¡æ–‡æ¡£

## ğŸ“– æ¨¡å—æ¦‚è¿°

TinyAI-DL-Funcæ˜¯TinyAIæ·±åº¦å­¦ä¹ æ¡†æ¶çš„æ ¸å¿ƒå‡½æ•°è®¡ç®—æ¨¡å—ï¼Œæä¾›äº†å®Œæ•´çš„è‡ªåŠ¨å¾®åˆ†å¼•æ“å®ç°ã€‚è¯¥æ¨¡å—æ˜¯æ•´ä¸ªæ·±åº¦å­¦ä¹ æ¡†æ¶çš„æ•°å­¦è¿ç®—åŸºç¡€ï¼Œé€šè¿‡åŠ¨æ€è®¡ç®—å›¾æ„å»ºå’Œè‡ªåŠ¨æ¢¯åº¦è®¡ç®—ï¼Œä¸ºç¥ç»ç½‘ç»œè®­ç»ƒæä¾›äº†å¼ºå¤§çš„æŠ€æœ¯æ”¯æ’‘ã€‚

### æ ¸å¿ƒè®¾è®¡ç†å¿µ

- **åŠ¨æ€è®¡ç®—å›¾**: è¿è¡Œæ—¶æ„å»ºè®¡ç®—å›¾ï¼Œæ”¯æŒçµæ´»çš„æ§åˆ¶æµå’Œç½‘ç»œç»“æ„
- **é›¶æ‰‹åŠ¨æ¢¯åº¦**: å®Œå…¨è‡ªåŠ¨åŒ–çš„æ¢¯åº¦è®¡ç®—ï¼Œæ— éœ€æ‰‹åŠ¨æ¨å¯¼å¾®åˆ†å…¬å¼
- **å‡½æ•°å¼ç¼–ç¨‹**: åŸºäºå‡½æ•°ç»„åˆçš„è®¾è®¡æ¨¡å¼ï¼Œæé«˜ä»£ç å¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§
- **ç±»å‹å®‰å…¨**: å¼ºç±»å‹ç³»ç»Ÿç¡®ä¿è®¡ç®—çš„æ­£ç¡®æ€§å’Œç¨³å®šæ€§
- **å†…å­˜é«˜æ•ˆ**: æ™ºèƒ½çš„å†…å­˜ç®¡ç†æœºåˆ¶ï¼Œä¼˜åŒ–è®­ç»ƒè¿‡ç¨‹ä¸­çš„å†…å­˜ä½¿ç”¨

## ğŸ—ï¸ æ•´ä½“æ¶æ„

### æ¶æ„å±‚æ¬¡å›¾

```mermaid
graph TB
    subgraph "ç”¨æˆ·æ¥å£å±‚"
        A[Variable API]
        B[æ•°å­¦è¿ç®—æ¥å£]
        C[æŸå¤±å‡½æ•°æ¥å£]
    end
    
    subgraph "è®¡ç®—å›¾å±‚"
        D[Variableç±»]
        E[FunctionåŸºç±»]
        F[å…·ä½“å‡½æ•°å®ç°]
    end
    
    subgraph "è¿ç®—å®ç°å±‚"
        G[åŸºç¡€è¿ç®—åŒ… base]
        H[æ•°å­¦å‡½æ•°åŒ… math]
        I[çŸ©é˜µè¿ç®—åŒ… matrix]
        J[æŸå¤±å‡½æ•°åŒ… loss]
    end
    
    subgraph "åº•å±‚æ”¯æ’‘å±‚"
        K[NdArrayå¤šç»´æ•°ç»„]
        L[Configé…ç½®ç®¡ç†]
        M[Utilså·¥å…·å‡½æ•°]
    end
    
    A --> D
    B --> E
    C --> J
    D --> E
    E --> F
    F --> G
    F --> H
    F --> I
    F --> J
    D --> K
    E --> K
    L --> D
    M --> D
```

### æ¨¡å—ç»„ç»‡ç»“æ„

```
tinyai-deeplearning-func/
â”œâ”€â”€ src/main/java/io/leavesfly/tinyai/
â”‚   â”œâ”€â”€ func/
â”‚   â”‚   â”œâ”€â”€ Variable.java          # è‡ªåŠ¨å¾®åˆ†å˜é‡æ ¸å¿ƒç±»
â”‚   â”‚   â”œâ”€â”€ Function.java          # å‡½æ•°æ“ä½œæŠ½è±¡åŸºç±»
â”‚   â”‚   â”œâ”€â”€ base/                  # åŸºç¡€å››åˆ™è¿ç®—
â”‚   â”‚   â”‚   â”œâ”€â”€ Add.java           # åŠ æ³•è¿ç®—ï¼ˆæ”¯æŒå¹¿æ’­ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ Sub.java           # å‡æ³•è¿ç®—
â”‚   â”‚   â”‚   â”œâ”€â”€ Mul.java           # ä¹˜æ³•è¿ç®—ï¼ˆæ”¯æŒå¹¿æ’­ï¼‰
â”‚   â”‚   â”‚   â”œâ”€â”€ Div.java           # é™¤æ³•è¿ç®—
â”‚   â”‚   â”‚   â””â”€â”€ Neg.java           # å–è´Ÿè¿ç®—
â”‚   â”‚   â”œâ”€â”€ math/                  # æ•°å­¦å‡½æ•°åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ æ¿€æ´»å‡½æ•°ç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ReLu.java      # ReLUæ¿€æ´»å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sigmoid.java   # Sigmoidæ¿€æ´»å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Tanh.java      # Tanhæ¿€æ´»å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ GELU.java      # GELUæ¿€æ´»å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ åŸºç¡€æ•°å­¦å‡½æ•°ç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Exp.java       # æŒ‡æ•°å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Log.java       # å¯¹æ•°å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sin.java       # æ­£å¼¦å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Cos.java       # ä½™å¼¦å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Pow.java       # å¹‚å‡½æ•°
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Squ.java       # å¹³æ–¹å‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ å®ç”¨å‡½æ•°ç»„
â”‚   â”‚   â”‚       â”œâ”€â”€ Clip.java      # æ•°å€¼è£å‰ª
â”‚   â”‚   â”‚       â”œâ”€â”€ Max.java       # æœ€å¤§å€¼å‡½æ•°
â”‚   â”‚   â”‚       â””â”€â”€ Min.java       # æœ€å°å€¼å‡½æ•°
â”‚   â”‚   â”œâ”€â”€ matrix/                # çŸ©é˜µè¿ç®—åº“
â”‚   â”‚   â”‚   â”œâ”€â”€ æ ¸å¿ƒè¿ç®—ç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MatMul.java    # çŸ©é˜µä¹˜æ³•
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Linear.java    # çº¿æ€§å˜æ¢
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Transpose.java # çŸ©é˜µè½¬ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ å½¢çŠ¶æ“ä½œç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Reshape.java   # å½¢çŠ¶é‡å¡‘
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BroadcastTo.java # å¹¿æ’­æ“ä½œ
â”‚   â”‚   â”‚   â”œâ”€â”€ èšåˆè¿ç®—ç»„
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sum.java       # æ±‚å’Œè¿ç®—
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ SumTo.java     # æŒ‡å®šç»´åº¦æ±‚å’Œ
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SoftMax.java   # Softmaxå‡½æ•°
â”‚   â”‚   â”‚   â””â”€â”€ ç´¢å¼•æ“ä½œç»„
â”‚   â”‚   â”‚       â””â”€â”€ GetItem.java   # ç´¢å¼•å–å€¼
â”‚   â”‚   â””â”€â”€ loss/                  # æŸå¤±å‡½æ•°åº“
â”‚   â”‚       â”œâ”€â”€ MeanSE.java        # å‡æ–¹è¯¯å·®æŸå¤±
â”‚   â”‚       â”œâ”€â”€ SoftmaxCE.java     # Softmaxäº¤å‰ç†µæŸå¤±
â”‚   â”‚       â””â”€â”€ SigmoidCE.java     # Sigmoidäº¤å‰ç†µæŸå¤±
â”‚   â””â”€â”€ util/
â”‚       â”œâ”€â”€ Config.java            # é…ç½®ç®¡ç†ç±»
â”‚       â””â”€â”€ Utils.java             # å·¥å…·å‡½æ•°é›†åˆ
â””â”€â”€ doc/
    â”œâ”€â”€ æµ‹è¯•ä¿®å¤æŠ¥å‘Š.md              # å†å²æµ‹è¯•ä¿®å¤è®°å½•
    â””â”€â”€ æŠ€æœ¯æ¶æ„è®¾è®¡æ–‡æ¡£.md          # æœ¬æ–‡æ¡£
```

## ğŸ”§ æ ¸å¿ƒç»„ä»¶è®¾è®¡

### Variableç±» - è‡ªåŠ¨å¾®åˆ†å˜é‡

`Variable`ç±»æ˜¯è‡ªåŠ¨å¾®åˆ†å¼•æ“çš„æ ¸å¿ƒï¼Œå®ƒä¸ä»…æ˜¯æ•°æ®çš„å®¹å™¨ï¼Œæ›´æ˜¯è®¡ç®—å›¾çš„èŠ‚ç‚¹ã€‚

#### æ ¸å¿ƒèŒè´£
- **æ•°æ®ç®¡ç†**: å­˜å‚¨å˜é‡çš„å€¼(NdArray)å’Œæ¢¯åº¦ä¿¡æ¯
- **è®¡ç®—å›¾ç»´æŠ¤**: é€šè¿‡creatorå­—æ®µç»´æŠ¤å‰å‘ä¼ æ’­æ—¶çš„å‡½æ•°è°ƒç”¨å…³ç³»
- **è¿ç®—æ¥å£**: æä¾›ä¸°å¯Œçš„æ•°å­¦è¿ç®—æ–¹æ³•
- **æ¢¯åº¦ä¼ æ’­**: å®ç°è‡ªåŠ¨çš„åå‘ä¼ æ’­ç®—æ³•

#### å…³é”®ç‰¹æ€§
```java
public class Variable implements Serializable {
    private String name;               // å˜é‡åç§°ï¼Œç”¨äºè°ƒè¯•
    private NdArray value;            // å˜é‡å€¼
    private NdArray grad;             // æ¢¯åº¦å€¼
    private transient Function creator; // åˆ›å»ºè¯¥å˜é‡çš„å‡½æ•°
    private boolean requireGrad;       // æ˜¯å¦éœ€è¦è®¡ç®—æ¢¯åº¦
    
    // åå‘ä¼ æ’­æ–¹æ³•
    public void backward()             // é€’å½’å®ç°
    public void backwardIterative()   // è¿­ä»£å®ç°ï¼ˆé¿å…æ ˆæº¢å‡ºï¼‰
    
    // ä¸°å¯Œçš„æ•°å­¦è¿ç®—API
    public Variable add(Variable other)
    public Variable mul(Variable other)
    public Variable matMul(Variable other)
    public Variable relu()
    public Variable sigmoid()
    // ... æ›´å¤šè¿ç®—æ–¹æ³•
}
```

#### è®¾è®¡äº®ç‚¹
1. **åŒé‡åå‘ä¼ æ’­å®ç°**: æä¾›é€’å½’å’Œè¿­ä»£ä¸¤ç§åå‘ä¼ æ’­ç®—æ³•ï¼Œé€‚åº”ä¸åŒåœºæ™¯éœ€æ±‚
2. **æ¢¯åº¦ç´¯ç§¯æœºåˆ¶**: æ”¯æŒå¤šæ¬¡åå‘ä¼ æ’­çš„æ¢¯åº¦ç´¯åŠ ï¼Œæ»¡è¶³å¤æ‚è®­ç»ƒåœºæ™¯
3. **å†…å­˜ç®¡ç†ä¼˜åŒ–**: é€šè¿‡`unChainBackward()`æ–¹æ³•æ”¯æŒè®¡ç®—å›¾çš„æ–­å¼€ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
4. **åºåˆ—åŒ–æ”¯æŒ**: æ ¸å¿ƒæ•°æ®å¯åºåˆ—åŒ–ï¼Œcreatorå­—æ®µä½¿ç”¨transienté¿å…å¾ªç¯å¼•ç”¨

### Functionç±» - å‡½æ•°æ“ä½œåŸºç±»

`Function`ç±»æ˜¯æ‰€æœ‰æ•°å­¦å‡½æ•°çš„æŠ½è±¡åŸºç±»ï¼Œå®šä¹‰äº†å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­çš„æ ‡å‡†æ¥å£ã€‚

#### è®¾è®¡æ¨¡å¼
- **æ¨¡æ¿æ–¹æ³•æ¨¡å¼**: `call`æ–¹æ³•å®šä¹‰äº†å‡½æ•°æ‰§è¡Œçš„æ ‡å‡†æµç¨‹
- **ç­–ç•¥æ¨¡å¼**: å­ç±»å®ç°å…·ä½“çš„å‰å‘å’Œåå‘ä¼ æ’­ç®—æ³•

#### æ‰§è¡Œæµç¨‹
```java
public Variable call(Variable... inputs) {
    // 1. è¾“å…¥éªŒè¯
    if (inputs.length != requireInputNum() && requireInputNum() > 0) {
        throw new RuntimeException("è¾“å…¥å‚æ•°æ•°é‡é”™è¯¯");
    }
    
    // 2. æå–NdArrayå€¼
    NdArray[] ndArrayInputs = extractValues(inputs);
    
    // 3. æ‰§è¡Œå‰å‘ä¼ æ’­
    NdArray output = forward(ndArrayInputs);
    
    // 4. åˆ›å»ºè¾“å‡ºå˜é‡
    Variable result = new Variable(output);
    
    // 5. æ„å»ºè®¡ç®—å›¾ï¼ˆä»…åœ¨è®­ç»ƒæ¨¡å¼ä¸‹ï¼‰
    if (Config.train) {
        this.inputs = inputs;
        this.output = result;
        result.setCreator(this);
    }
    
    return result;
}
```

#### æ ¸å¿ƒæ¥å£
```java
public abstract class Function {
    // å‰å‘ä¼ æ’­è®¡ç®—
    public abstract NdArray forward(NdArray... inputs);
    
    // åå‘ä¼ æ’­è®¡ç®—ï¼ˆæ±‚å¯¼ï¼‰
    public abstract List<NdArray> backward(NdArray yGrad);
    
    // è¾“å…¥å‚æ•°æ•°é‡è¦æ±‚
    public abstract int requireInputNum();
    
    // èµ„æºæ¸…ç†
    public void unChain() {
        this.inputs = null;
        this.output = null;
    }
}
```

## ğŸ“Š æ•°å­¦å‡½æ•°åº“è®¾è®¡

### åŸºç¡€è¿ç®—åŒ… (base)

åŸºç¡€è¿ç®—åŒ…å®ç°äº†å››åˆ™è¿ç®—çš„æ ¸å¿ƒåŠŸèƒ½ï¼Œæ‰€æœ‰è¿ç®—éƒ½æ”¯æŒå¹¿æ’­æœºåˆ¶ã€‚

#### å¹¿æ’­æœºåˆ¶è®¾è®¡
```java
// Addç±»ä¸­çš„å¹¿æ’­åˆ¤æ–­é€»è¾‘
private boolean isBroadcastable(Shape srcShape, Shape dstShape) {
    // ä»åå¾€å‰æ£€æŸ¥ç»´åº¦æ˜¯å¦å…¼å®¹
    if (srcShape.getDimNum() <= dstShape.getDimNum()) {
        for (int i = 0; i < srcShape.getDimNum(); i++) {
            int srcDimIndex = srcShape.getDimNum() - 1 - i;
            int dstDimIndex = dstShape.getDimNum() - 1 - i;
            
            int srcDim = srcShape.getDimension(srcDimIndex);
            int dstDim = dstShape.getDimension(dstDimIndex);
            
            // å¹¿æ’­è§„åˆ™ï¼šç»´åº¦ç›¸ç­‰ï¼Œæˆ–è€…æºç»´åº¦ä¸º1
            if (srcDim != dstDim && srcDim != 1) {
                return false;
            }
        }
        return true;
    }
    return false;
}
```

#### æ¢¯åº¦ä¼ æ’­å¤„ç†
- **Add/Sub**: æ¢¯åº¦ç›´æ¥ä¼ é€’ï¼Œéœ€è¦å¤„ç†å¹¿æ’­æƒ…å†µä¸‹çš„å½¢çŠ¶è¿˜åŸ
- **Mul**: éœ€è¦è€ƒè™‘ä¸¤ä¸ªè¾“å…¥çš„äº¤å‰æ¢¯åº¦
- **Div**: åˆ†å­å’Œåˆ†æ¯çš„æ¢¯åº¦è®¡ç®—ä¸åŒ

### æ•°å­¦å‡½æ•°åŒ… (math)

æ•°å­¦å‡½æ•°åŒ…æä¾›äº†ä¸°å¯Œçš„æ•°å­¦å‡½æ•°å®ç°ï¼ŒåŒ…æ‹¬æ¿€æ´»å‡½æ•°å’ŒåŸºç¡€æ•°å­¦å‡½æ•°ã€‚

#### æ¿€æ´»å‡½æ•°ç»„
```java
// Sigmoidå‡½æ•°çš„å®ç°ç¤ºä¾‹
public class Sigmoid extends Function {
    @Override
    public NdArray forward(NdArray... inputs) {
        return inputs[0].sigmoid();
    }
    
    @Override
    public List<NdArray> backward(NdArray yGrad) {
        NdArray x = inputs[0].getValue();
        NdArray sigmoidX = x.sigmoid();
        // âˆ‚sigmoid(x)/âˆ‚x = sigmoid(x) * (1 - sigmoid(x))
        return Collections.singletonList(
            yGrad.mul(sigmoidX).mul(
                NdArray.ones(sigmoidX.getShape()).sub(sigmoidX)
            )
        );
    }
}
```

#### æ•°å€¼ç¨³å®šæ€§è€ƒè™‘
- **Sigmoid**: å¤„ç†æå¤§å€¼è¾“å…¥ï¼Œé¿å…æ•°å€¼æº¢å‡º
- **Tanh**: å€¼åŸŸè¾¹ç•Œå¤„ç†ï¼Œç¡®ä¿æ¢¯åº¦è®¡ç®—æ­£ç¡®
- **Exp/Log**: å¤„ç†æå€¼æƒ…å†µï¼Œé˜²æ­¢æ•°å€¼å¼‚å¸¸

### çŸ©é˜µè¿ç®—åŒ… (matrix)

çŸ©é˜µè¿ç®—åŒ…æ˜¯æ·±åº¦å­¦ä¹ è®¡ç®—çš„æ ¸å¿ƒï¼Œæä¾›äº†å®Œæ•´çš„çº¿æ€§ä»£æ•°è¿ç®—æ”¯æŒã€‚

#### çŸ©é˜µä¹˜æ³•è®¾è®¡
```java
public class MatMul extends Function {
    @Override
    public NdArray forward(NdArray... inputs) {
        return inputs[0].dot(inputs[1]);
    }
    
    @Override
    public List<NdArray> backward(NdArray yGrad) {
        NdArray x = inputs[0].getValue();
        NdArray w = inputs[1].getValue();
        
        // âˆ‚(x*w)/âˆ‚x = yGrad * w^T
        // âˆ‚(x*w)/âˆ‚w = x^T * yGrad
        return Arrays.asList(
            yGrad.dot(w.transpose()),
            x.transpose().dot(yGrad)
        );
    }
}
```

#### çº¿æ€§å˜æ¢ä¼˜åŒ–
`Linear`ç±»å®ç°äº†é«˜æ•ˆçš„çº¿æ€§å˜æ¢æ“ä½œï¼Œæ”¯æŒå¯é€‰çš„åç½®é¡¹ï¼š
- çŸ©é˜µä¹˜æ³• + åç½®åŠ æ³•çš„ç»„åˆæ“ä½œ
- è‡ªåŠ¨å¤„ç†åç½®çš„å¹¿æ’­
- ä¼˜åŒ–çš„æ¢¯åº¦è®¡ç®—

### æŸå¤±å‡½æ•°åŒ… (loss)

æŸå¤±å‡½æ•°åŒ…æä¾›äº†å¸¸ç”¨çš„æŸå¤±å‡½æ•°å®ç°ï¼Œæ”¯æŒåˆ†ç±»å’Œå›å½’ä»»åŠ¡ã€‚

#### å‡æ–¹è¯¯å·®æŸå¤±
```java
public class MeanSE extends Function {
    @Override
    public NdArray forward(NdArray... inputs) {
        NdArray predict = inputs[0];
        NdArray label = inputs[1];
        int size = predict.getShape().size();
        return predict.sub(label).square().sum().divNum(size);
    }
    
    @Override
    public List<NdArray> backward(NdArray yGrad) {
        NdArray predict = inputs[0].getValue();
        NdArray label = inputs[1].getValue();
        NdArray diff = predict.sub(label);
        int len = diff.getShape().size();
        
        // âˆ‚MSE/âˆ‚predict = 2 * (predict - label) / n
        NdArray gx0 = yGrad.broadcastTo(diff.getShape())
                          .mul(diff).mulNum(2).divNum(len);
        return Arrays.asList(gx0, gx0.neg());
    }
}
```

## ğŸš€ æ€§èƒ½ä¼˜åŒ–è®¾è®¡

### å†…å­˜ç®¡ç†ç­–ç•¥

1. **åŠ¨æ€è®¡ç®—å›¾æ„å»º**: åªåœ¨è®­ç»ƒæ¨¡å¼ä¸‹æ„å»ºè®¡ç®—å›¾ï¼Œæ¨ç†æ—¶èŠ‚çœå†…å­˜
2. **æ¢¯åº¦å»¶è¿Ÿé‡Šæ”¾**: æä¾›`clearGrad()`æ–¹æ³•æ‰‹åŠ¨æ¸…ç†æ¢¯åº¦
3. **è®¡ç®—å›¾æ–­å¼€**: `unChainBackward()`æ–¹æ³•æ”¯æŒRNNåœºæ™¯çš„å†…å­˜ä¼˜åŒ–
4. **transientå­—æ®µ**: creatorå­—æ®µä¸å‚ä¸åºåˆ—åŒ–ï¼Œé¿å…å¾ªç¯å¼•ç”¨

### è®¡ç®—ä¼˜åŒ–

1. **å¹¿æ’­æœºåˆ¶**: é«˜æ•ˆçš„å¼ é‡å¹¿æ’­ç®—æ³•ï¼Œå‡å°‘å†…å­˜æ‹·è´
2. **åŸåœ°æ“ä½œ**: åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ä½¿ç”¨åŸåœ°æ“ä½œå‡å°‘ä¸´æ—¶å¯¹è±¡
3. **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡æ•°æ®çš„é«˜æ•ˆå¤„ç†
4. **æ•°å€¼ç¨³å®šæ€§**: åœ¨æ•°å­¦å‡½æ•°ä¸­åŠ å…¥æ•°å€¼ç¨³å®šæ€§ä¿æŠ¤

### å¹¶å‘æ”¯æŒ

1. **çº¿ç¨‹å®‰å…¨**: æ ¸å¿ƒç±»è®¾è®¡ä¸ºçº¿ç¨‹å®‰å…¨ï¼Œæ”¯æŒå¹¶è¡Œè®­ç»ƒ
2. **æ— çŠ¶æ€å‡½æ•°**: Functionå®ä¾‹å¯ä»¥å¤ç”¨ï¼Œå‡å°‘å¯¹è±¡åˆ›å»ºå¼€é”€
3. **æ¢¯åº¦ç´¯ç§¯**: æ”¯æŒå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„æ¢¯åº¦ç´¯ç§¯æ“ä½œ

## ğŸ§ª è´¨é‡ä¿è¯ä½“ç³»

### æµ‹è¯•è¦†ç›–ç­–ç•¥

- **100%æµ‹è¯•è¦†ç›–**: æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½æœ‰å¯¹åº”çš„å•å…ƒæµ‹è¯•
- **è¾¹ç•Œå€¼æµ‹è¯•**: è¦†ç›–æå€¼æƒ…å†µå’Œè¾¹ç•Œæ¡ä»¶
- **æ•°å€¼ç²¾åº¦éªŒè¯**: ç¡®ä¿æ•°å­¦è®¡ç®—çš„å‡†ç¡®æ€§
- **æ¢¯åº¦éªŒè¯**: é€šè¿‡æ•°å€¼æ¢¯åº¦éªŒè¯è‡ªåŠ¨å¾®åˆ†çš„æ­£ç¡®æ€§

### æµ‹è¯•ç»„ç»‡ç»“æ„
```
test/java/io/leavesfly/tinyai/func/
â”œâ”€â”€ VariableTest.java              # Variableæ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ base/
â”‚   â”œâ”€â”€ ArithmeticTest.java        # å››åˆ™è¿ç®—æµ‹è¯•
â”‚   â””â”€â”€ BroadcastTest.java         # å¹¿æ’­æœºåˆ¶æµ‹è¯•
â”œâ”€â”€ math/
â”‚   â”œâ”€â”€ ActivationTest.java        # æ¿€æ´»å‡½æ•°æµ‹è¯•
â”‚   â”œâ”€â”€ MathFuncTest.java          # æ•°å­¦å‡½æ•°æµ‹è¯•
â”‚   â””â”€â”€ NumericalStabilityTest.java # æ•°å€¼ç¨³å®šæ€§æµ‹è¯•
â”œâ”€â”€ matrix/
â”‚   â”œâ”€â”€ MatrixOpsTest.java         # çŸ©é˜µè¿ç®—æµ‹è¯•
â”‚   â””â”€â”€ LinearAlgebraTest.java     # çº¿æ€§ä»£æ•°æµ‹è¯•
â””â”€â”€ loss/
    â””â”€â”€ LossFunctionTest.java      # æŸå¤±å‡½æ•°æµ‹è¯•
```

### æ•°å€¼ç²¾åº¦ä¿è¯

1. **åŒç²¾åº¦è®¡ç®—**: å…³é”®è®¡ç®—ä½¿ç”¨åŒç²¾åº¦æµ®ç‚¹æ•°
2. **è¯¯å·®å®¹å¿**: åˆç†è®¾ç½®æ•°å€¼æ¯”è¾ƒçš„è¯¯å·®é˜ˆå€¼
3. **ç¨³å®šæ€§ç®—æ³•**: åœ¨å¯èƒ½äº§ç”Ÿæ•°å€¼é—®é¢˜çš„åœ°æ–¹ä½¿ç”¨ç¨³å®šç®—æ³•
4. **è¾¹ç•Œæ£€æŸ¥**: å¯¹è¾“å…¥å‚æ•°è¿›è¡Œåˆç†æ€§æ£€æŸ¥

## ğŸ”§ é…ç½®ä¸æ‰©å±•æœºåˆ¶

### é…ç½®ç®¡ç†

`Config`ç±»æä¾›äº†å…¨å±€é…ç½®ç®¡ç†ï¼š
```java
public class Config {
    // è®­ç»ƒæ¨¡å¼å¼€å…³ï¼Œæ§åˆ¶è®¡ç®—å›¾æ„å»º
    public static boolean train = true;
    
    // æ•°å€¼ç²¾åº¦é…ç½®
    public static float epsilon = 1e-7f;
    
    // å…¶ä»–é…ç½®é¡¹...
}
```

### æ‰©å±•æœºåˆ¶

#### æ·»åŠ æ–°çš„æ•°å­¦å‡½æ•°
1. ç»§æ‰¿`Function`æŠ½è±¡ç±»
2. å®ç°`forward`ã€`backward`å’Œ`requireInputNum`æ–¹æ³•
3. åœ¨`Variable`ç±»ä¸­æ·»åŠ å¯¹åº”çš„ä¾¿æ·æ–¹æ³•
4. ç¼–å†™å®Œæ•´çš„å•å…ƒæµ‹è¯•

#### ç¤ºä¾‹ï¼šæ·»åŠ è‡ªå®šä¹‰æ¿€æ´»å‡½æ•°
```java
public class Swish extends Function {
    @Override
    public NdArray forward(NdArray... inputs) {
        // Swish(x) = x * sigmoid(x)
        NdArray x = inputs[0];
        return x.mul(x.sigmoid());
    }
    
    @Override
    public List<NdArray> backward(NdArray yGrad) {
        NdArray x = inputs[0].getValue();
        NdArray sigmoid = x.sigmoid();
        // âˆ‚Swish/âˆ‚x = sigmoid + x * sigmoid * (1 - sigmoid)
        NdArray grad = sigmoid.add(
            x.mul(sigmoid).mul(
                NdArray.ones(sigmoid.getShape()).sub(sigmoid)
            )
        );
        return Collections.singletonList(yGrad.mul(grad));
    }
    
    @Override
    public int requireInputNum() {
        return 1;
    }
}

// åœ¨Variableç±»ä¸­æ·»åŠ ä¾¿æ·æ–¹æ³•
public Variable swish() {
    Function function = new Swish();
    return function.call(this);
}
```

## ğŸ“ˆ æœªæ¥å‘å±•æ–¹å‘

### çŸ­æœŸè®¡åˆ’
1. **GPUåŠ é€Ÿæ”¯æŒ**: æ·»åŠ CUDAåç«¯æ”¯æŒ
2. **æ›´å¤šæ•°å­¦å‡½æ•°**: æ‰©å±•æ•°å­¦å‡½æ•°åº“
3. **æ€§èƒ½ä¼˜åŒ–**: è¿›ä¸€æ­¥ä¼˜åŒ–è®¡ç®—å’Œå†…å­˜æ•ˆç‡
4. **å¹¶è¡Œè®­ç»ƒå¢å¼º**: æ”¹è¿›å¹¶è¡Œè®­ç»ƒæ”¯æŒ

### é•¿æœŸè§„åˆ’
1. **åˆ†å¸ƒå¼è®­ç»ƒ**: æ”¯æŒå¤šæœºå¤šå¡è®­ç»ƒ
2. **åŠ¨æ€é‡åŒ–**: æ·»åŠ è®­ç»ƒæ—¶é‡åŒ–æ”¯æŒ
3. **å›¾ä¼˜åŒ–**: å®ç°è®¡ç®—å›¾çš„è‡ªåŠ¨ä¼˜åŒ–
4. **JITç¼–è¯‘**: æ·»åŠ å³æ—¶ç¼–è¯‘æ”¯æŒæé«˜æ€§èƒ½

## ğŸ“ æ€»ç»“

TinyAIè‡ªåŠ¨å¾®åˆ†å¼•æ“é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„ï¼Œæä¾›äº†å®Œæ•´ã€é«˜æ•ˆã€æ˜“ç”¨çš„è‡ªåŠ¨å¾®åˆ†åŠŸèƒ½ã€‚å…¶ä¸»è¦ä¼˜åŠ¿åŒ…æ‹¬ï¼š

1. **å®Œæ•´æ€§**: æä¾›äº†ä»åŸºç¡€è¿ç®—åˆ°å¤æ‚æŸå¤±å‡½æ•°çš„å®Œæ•´æ•°å­¦å‡½æ•°åº“
2. **é«˜æ•ˆæ€§**: é€šè¿‡å¤šç§ä¼˜åŒ–ç­–ç•¥ç¡®ä¿è®¡ç®—å’Œå†…å­˜æ•ˆç‡
3. **æ˜“ç”¨æ€§**: ç®€æ´çš„APIè®¾è®¡å’Œä¸°å¯Œçš„æ–‡æ¡£æ”¯æŒ
4. **å¯æ‰©å±•æ€§**: æ¸…æ™°çš„æ¶æ„è®¾è®¡ä½¿å¾—æ·»åŠ æ–°åŠŸèƒ½å˜å¾—ç®€å•
5. **å¯é æ€§**: 100%çš„æµ‹è¯•è¦†ç›–ç‡ç¡®ä¿ä»£ç è´¨é‡

è¯¥å¼•æ“ä¸ºTinyAIæ·±åº¦å­¦ä¹ æ¡†æ¶æä¾›äº†åšå®çš„æ•°å­¦åŸºç¡€ï¼Œæ”¯æŒæ„å»ºä»ç®€å•çš„çº¿æ€§å›å½’åˆ°å¤æ‚çš„æ·±åº¦ç¥ç»ç½‘ç»œçš„å„ç§æ¨¡å‹ã€‚