# 20.1 AIç¼–ç¨‹åŠ©æ‰‹ï¼šä»£ç æ™ºèƒ½åŒ–çš„å®è·µ

> è®©AIæˆä¸ºä½ çš„ç¼–ç¨‹ä¼™ä¼´ï¼šä»ä»£ç åˆ†æåˆ°æ™ºèƒ½ç”Ÿæˆ

## å¼•è¨€

æƒ³è±¡ä¸€ä¸‹ï¼Œå½“ä½ åœ¨ç¼–å†™ä»£ç æ—¶ï¼Œæœ‰ä¸€ä¸ªç»éªŒä¸°å¯Œçš„ç¨‹åºå‘˜å¯¼å¸ˆååœ¨ä½ èº«è¾¹ï¼š
- ä»–èƒ½ç¬é—´åˆ†æä½ çš„ä»£ç è´¨é‡ï¼ŒæŒ‡å‡ºæ½œåœ¨é—®é¢˜
- ä»–èƒ½æ ¹æ®ä½ çš„éœ€æ±‚å¿«é€Ÿç”Ÿæˆä»£ç æ¡†æ¶
- ä»–èƒ½å‘ç°ä»£ç ä¸­çš„"åå‘³é“"ï¼Œæä¾›é‡æ„å»ºè®®
- ä»–èƒ½å¸®ä½ è¯Šæ–­bugï¼Œç”šè‡³è‡ªåŠ¨ä¿®å¤é”™è¯¯

è¿™å°±æ˜¯æˆ‘ä»¬è¦æ„å»ºçš„**AIç¼–ç¨‹åŠ©æ‰‹**â€”â€”ä¸€ä¸ªé›†ä»£ç åˆ†æã€ç”Ÿæˆã€é‡æ„ã€è°ƒè¯•äºä¸€ä½“çš„æ™ºèƒ½ç¼–ç¨‹è¾…åŠ©ç³»ç»Ÿã€‚

## æ ¸å¿ƒæ¦‚å¿µ

### ä»€ä¹ˆæ˜¯AIç¼–ç¨‹åŠ©æ‰‹ï¼Ÿ

AIç¼–ç¨‹åŠ©æ‰‹æ˜¯å°†äººå·¥æ™ºèƒ½æŠ€æœ¯åº”ç”¨äºè½¯ä»¶å¼€å‘å…¨æµç¨‹çš„æ™ºèƒ½ç³»ç»Ÿã€‚å®ƒä¸æ˜¯ç®€å•çš„ä»£ç è¡¥å…¨å·¥å…·ï¼Œè€Œæ˜¯ä¸€ä¸ªèƒ½å¤Ÿï¼š

1. **ç†è§£ä»£ç **ï¼šåˆ†æä»£ç ç»“æ„ã€è¯†åˆ«æ¨¡å¼ã€è¯„ä¼°è´¨é‡
2. **ç”Ÿæˆä»£ç **ï¼šæ ¹æ®è‡ªç„¶è¯­è¨€æè¿°åˆ›å»ºä»£ç 
3. **ä¼˜åŒ–ä»£ç **ï¼šå‘ç°æ”¹è¿›æœºä¼šã€æä¾›é‡æ„æ–¹æ¡ˆ
4. **è¯Šæ–­é—®é¢˜**ï¼šè¯†åˆ«é”™è¯¯ã€åˆ†æåŸå› ã€å»ºè®®ä¿®å¤

### ç”Ÿæ´»ç±»æ¯”ï¼šç¼–ç¨‹å¯¼å¸ˆ

å¯ä»¥æŠŠAIç¼–ç¨‹åŠ©æ‰‹ç±»æ¯”ä¸ºä¸€ä¸ªå…¨èƒ½çš„ç¼–ç¨‹å¯¼å¸ˆï¼š

- **ä»£ç åˆ†æå™¨** = ä»£ç å®¡æŸ¥ä¸“å®¶
  - åƒè€å¸ˆæ‰¹æ”¹ä½œä¸šä¸€æ ·æ£€æŸ¥ä»£ç 
  - æŒ‡å‡ºè¯­æ³•é”™è¯¯ã€é€»è¾‘é—®é¢˜ã€é£æ ¼é—®é¢˜
  
- **ä»£ç ç”Ÿæˆå™¨** = ä»£ç æ¨¡æ¿ä¸“å®¶
  - åƒå»ºç­‘å¸ˆæä¾›è®¾è®¡å›¾çº¸
  - æ ¹æ®éœ€æ±‚å¿«é€Ÿç”Ÿæˆä»£ç æ¡†æ¶
  
- **é‡æ„ä»£ç†** = ä»£ç ä¼˜åŒ–é¡¾é—®
  - åƒå®¶è£…è®¾è®¡å¸ˆæ”¹é€ è€æˆ¿å­
  - è¯†åˆ«æ”¹è¿›ç©ºé—´ï¼Œæä¾›ä¼˜åŒ–æ–¹æ¡ˆ
  
- **è°ƒè¯•ä»£ç†** = é—®é¢˜è¯Šæ–­åŒ»ç”Ÿ
  - åƒåŒ»ç”Ÿè¯Šæ–­ç—…æƒ…
  - åˆ†æç—‡çŠ¶ã€æ‰¾å‡ºç—…å› ã€å¼€å‡ºå¤„æ–¹

## ç³»ç»Ÿæ¶æ„

### æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "ç”¨æˆ·æ¥å£å±‚"
        UI[AICodingCursor<br/>ç»Ÿä¸€æ¥å£]
        DEMO[CursorDemo<br/>äº¤äº’å¼æ¼”ç¤º]
    end
    
    subgraph "æ ¸å¿ƒåŠŸèƒ½å±‚"
        ANALYZER[CodeAnalyzer<br/>ä»£ç åˆ†æå™¨]
        GENERATOR[CodeGenerator<br/>ä»£ç ç”Ÿæˆå™¨]
        REFACTOR[RefactorAgent<br/>é‡æ„ä»£ç†]
        DEBUG[DebugAgent<br/>è°ƒè¯•ä»£ç†]
    end
    
    subgraph "æ™ºèƒ½æ¨ç†å±‚"
        LLM[SimplifiedAdvancedAgent<br/>LLMé›†æˆ]
        PATTERN[PatternMatcher<br/>æ¨¡å¼åŒ¹é…å¼•æ“]
        TEMPLATE[TemplateEngine<br/>æ¨¡æ¿å¼•æ“]
    end
    
    subgraph "æ•°æ®å±‚"
        CACHE[AnalysisCache<br/>åˆ†æç¼“å­˜]
        PATTERNS[RefactorPatterns<br/>é‡æ„æ¨¡å¼åº“]
        ERRORS[ErrorPatterns<br/>é”™è¯¯æ¨¡å¼åº“]
    end
    
    UI --> ANALYZER
    UI --> GENERATOR
    UI --> REFACTOR
    UI --> DEBUG
    UI --> LLM
    
    ANALYZER --> PATTERN
    ANALYZER --> CACHE
    
    GENERATOR --> TEMPLATE
    
    REFACTOR --> PATTERNS
    
    DEBUG --> ERRORS
    
    DEMO --> UI
```

### æ ¸å¿ƒç»„ä»¶èŒè´£

| ç»„ä»¶åç§° | èŒè´£æè¿° | å…³é”®æŠ€æœ¯ | å¯¹åº”æ¨¡å— |
|---------|---------|---------|---------|
| **CodeAnalyzer** | ä»£ç ç»“æ„è§£æã€è¯­æ³•æ£€æŸ¥ã€åº¦é‡è®¡ç®— | æ­£åˆ™è¡¨è¾¾å¼ã€ASTåˆ†æã€å¤æ‚åº¦è®¡ç®— | CodeAnalyzer.java |
| **CodeGenerator** | åŸºäºæ¨¡æ¿å’Œéœ€æ±‚ç”Ÿæˆä»£ç  | æ¨¡æ¿å¼•æ“ã€ä¸Šä¸‹æ–‡æ¨æ–­ã€æ™ºèƒ½å‘½å | CodeGenerator.java |
| **RefactorAgent** | è¯†åˆ«ä»£ç å¼‚å‘³ã€æä¾›é‡æ„å»ºè®® | æ¨¡å¼è¯†åˆ«ã€å¯å‘å¼è¯„ä¼° | RefactorAgent.java |
| **DebugAgent** | é”™è¯¯è¯Šæ–­ã€ä¿®å¤å»ºè®®ã€è‡ªåŠ¨ä¿®å¤ | é”™è¯¯æ¨¡å¼åŒ¹é…ã€ä¿®å¤ç­–ç•¥åº“ | DebugAgent.java |
| **AICodingCursor** | ç»Ÿä¸€æ¥å£ã€åŠŸèƒ½åè°ƒ | é—¨é¢æ¨¡å¼ã€ç»„ä»¶ç¼–æ’ | AICodingCursor.java |

## æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. ä»£ç åˆ†æå™¨ï¼ˆCodeAnalyzerï¼‰

ä»£ç åˆ†æå™¨æ˜¯AIç¼–ç¨‹åŠ©æ‰‹çš„"çœ¼ç›"ï¼Œè´Ÿè´£ç†è§£å’Œè¯„ä¼°ä»£ç ã€‚

#### åˆ†ææµç¨‹

```mermaid
flowchart TD
    START([ä»£ç è¾“å…¥]) --> SYNTAX[è¯­æ³•æ£€æŸ¥]
    SYNTAX --> VALID{è¯­æ³•æœ‰æ•ˆ?}
    VALID -->|å¦| ISSUES[è®°å½•è¯­æ³•é—®é¢˜]
    VALID -->|æ˜¯| STRUCTURE[ç»“æ„åˆ†æ]
    STRUCTURE --> EXTRACT[æå–ä»£ç å…ƒç´ ]
    EXTRACT --> METRICS[è®¡ç®—ä»£ç åº¦é‡]
    METRICS --> QUALITY[è´¨é‡è¯„ä¼°]
    ISSUES --> RESULT[è¿”å›åˆ†æç»“æœ]
    QUALITY --> RESULT
    RESULT --> END([ç»“æŸ])
```

#### åˆ†æç»´åº¦

**1. è¯­æ³•æ£€æŸ¥**

æ£€æŸ¥ä»£ç çš„åŸºæœ¬è¯­æ³•æ­£ç¡®æ€§ï¼š

```java
// æ£€æŸ¥å†…å®¹ï¼š
- æ‹¬å·æ˜¯å¦åŒ¹é…ï¼š{ } ( ) [ ]
- åˆ†å·æ˜¯å¦ç¼ºå¤±
- å…³é”®å­—ä½¿ç”¨æ˜¯å¦æ­£ç¡®
- å­—ç¬¦ä¸²å¼•å·æ˜¯å¦é…å¯¹
```

**ç¤ºä¾‹**ï¼š

```java
// âŒ è¯­æ³•é”™è¯¯ç¤ºä¾‹
public class Example {
    public void test() {
        System.out.println("Hello"  // ç¼ºå°‘å³æ‹¬å·å’Œåˆ†å·
    // ç¼ºå°‘å³å¤§æ‹¬å·
}

// âœ… ä¿®å¤å
public class Example {
    public void test() {
        System.out.println("Hello");
    }
}
```

**2. ç»“æ„åˆ†æ**

æå–ä»£ç çš„ç»“æ„ä¿¡æ¯ï¼š

| ç»“æ„å…ƒç´  | æå–å†…å®¹ | ç¤ºä¾‹ |
|---------|---------|------|
| **ç±»å®šä¹‰** | ç±»åã€ä¿®é¥°ç¬¦ã€ç»§æ‰¿å…³ç³» | `public class User extends BaseEntity` |
| **æ–¹æ³•ç­¾å** | æ–¹æ³•åã€å‚æ•°ã€è¿”å›ç±»å‹ | `public String getName(int id)` |
| **å˜é‡å£°æ˜** | å˜é‡åã€ç±»å‹ã€ä¿®é¥°ç¬¦ | `private String name` |
| **å¯¼å…¥è¯­å¥** | å¯¼å…¥çš„åŒ…å’Œç±» | `import java.util.List` |

**3. ä»£ç åº¦é‡**

è®¡ç®—ä»£ç çš„é‡åŒ–æŒ‡æ ‡ï¼š

```java
// åº¦é‡æŒ‡æ ‡
åœˆå¤æ‚åº¦ï¼ˆCyclomatic Complexityï¼‰ï¼š
- è¡¡é‡ä»£ç çš„å¤æ‚ç¨‹åº¦
- è®¡ç®—æ–¹æ³•ï¼šç‹¬ç«‹è·¯å¾„æ•°é‡
- å»ºè®®å€¼ï¼š< 10

ä»£ç è¡Œæ•°ï¼š
- æ–¹æ³•è¡Œæ•°å»ºè®®ï¼š< 50è¡Œ
- ç±»è¡Œæ•°å»ºè®®ï¼š< 500è¡Œ

åµŒå¥—æ·±åº¦ï¼š
- å»ºè®®æœ€å¤§æ·±åº¦ï¼š< 6å±‚
```

**ç¤ºä¾‹**ï¼š

```java
// åœˆå¤æ‚åº¦ = 4ï¼ˆæœ‰4ä¸ªåˆ¤æ–­åˆ†æ”¯ï¼‰
public String getGrade(int score) {
    if (score >= 90) {          // +1
        return "A";
    } else if (score >= 80) {   // +1
        return "B";
    } else if (score >= 60) {   // +1
        return "C";
    } else {                     // +1
        return "F";
    }
}
```

**4. é—®é¢˜è¯†åˆ«**

è¯†åˆ«ä»£ç ä¸­çš„æ½œåœ¨é—®é¢˜ï¼š

| é—®é¢˜ç±»å‹ | æ£€æµ‹æ ‡å‡† | ä¸¥é‡çº§åˆ« |
|---------|---------|---------|
| **é•¿æ–¹æ³•** | æ–¹æ³•è¡Œæ•° > 50 | MEDIUM |
| **å¤§ç±»** | ç±»è¡Œæ•° > 500 | HIGH |
| **æ·±å±‚åµŒå¥—** | åµŒå¥—æ·±åº¦ > 6 | HIGH |
| **é«˜å¤æ‚åº¦** | åœˆå¤æ‚åº¦ > 15 | CRITICAL |
| **é‡å¤ä»£ç ** | ç›¸åŒä»£ç å— > 3æ¬¡ | HIGH |

#### è´¨é‡è¯„åˆ†æ¨¡å‹

ä»£ç è´¨é‡è¯„åˆ†ç»¼åˆè€ƒè™‘å¤šä¸ªç»´åº¦ï¼Œé‡‡ç”¨åŠ æƒè¯„åˆ†æ–¹å¼ï¼š

```
åŸºç¡€åˆ†ï¼š100åˆ†

æ‰£åˆ†è§„åˆ™ï¼š
1. è¯­æ³•é”™è¯¯ï¼š-30åˆ†
2. ä»£ç é—®é¢˜ï¼š
   - CRITICALï¼š-20åˆ†/ä¸ª
   - HIGHï¼š-10åˆ†/ä¸ª
   - MEDIUMï¼š-5åˆ†/ä¸ª
   - LOWï¼š-2åˆ†/ä¸ª
3. å¤æ‚åº¦ï¼š
   - å¤æ‚åº¦>15ï¼š-15åˆ†
   - å¤æ‚åº¦>10ï¼š-10åˆ†
   - å¤æ‚åº¦>5ï¼š-5åˆ†
4. é‡æ„å»ºè®®ï¼š
   - HIGHä¼˜å…ˆçº§ï¼š-3åˆ†/ä¸ª
   - MEDIUMä¼˜å…ˆçº§ï¼š-1åˆ†/ä¸ª

æœ€ç»ˆè¯„åˆ† = max(0, åŸºç¡€åˆ† - æ‰£åˆ†)
```

**è¯„åˆ†ç¤ºä¾‹**ï¼š

```java
// ç¤ºä¾‹ä»£ç 
public class UserService {
    // 50è¡Œä»£ç ...
    
    public User getUser(int id) {
        // 30è¡Œä»£ç ï¼Œåœˆå¤æ‚åº¦=12
        // åµŒå¥—æ·±åº¦=7
    }
}

// åˆ†æç»“æœï¼š
è¯­æ³•é”™è¯¯ï¼š0
é—®é¢˜åˆ—è¡¨ï¼š
- æ·±å±‚åµŒå¥—ï¼ˆåµŒå¥—=7ï¼‰ï¼šHIGH â†’ -10åˆ†
- é•¿æ–¹æ³•ï¼ˆ30è¡Œï¼‰ï¼šMEDIUM â†’ -5åˆ†
- é«˜å¤æ‚åº¦ï¼ˆ12ï¼‰ï¼šâ†’ -10åˆ†

æœ€ç»ˆè¯„åˆ†ï¼š100 - 10 - 5 - 10 = 75åˆ†
```

#### å®æˆ˜ç¤ºä¾‹

è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®Œæ•´çš„ä»£ç åˆ†æç¤ºä¾‹ï¼š

**è¾“å…¥ä»£ç **ï¼š

```java
public class Calculator {
    public int calculate(String operation, int a, int b) {
        if (operation.equals("add")) {
            if (a > 0) {
                if (b > 0) {
                    if (a + b < 1000) {
                        return a + b;
                    } else {
                        return 999;
                    }
                } else {
                    return a;
                }
            } else {
                return b;
            }
        } else if (operation.equals("subtract")) {
            return a - b;
        } else if (operation.equals("multiply")) {
            return a * b;
        } else if (operation.equals("divide")) {
            if (b != 0) {
                return a / b;
            } else {
                return 0;
            }
        }
        return 0;
    }
}
```

**åˆ†æè¾“å‡º**ï¼š

```
=== ä»£ç åˆ†ææŠ¥å‘Š ===

âœ“ è¯­æ³•æ£€æŸ¥ï¼šé€šè¿‡

ğŸ“Š ä»£ç ç»“æ„ï¼š
- ç±»ï¼š1ä¸ªï¼ˆCalculatorï¼‰
- æ–¹æ³•ï¼š1ä¸ªï¼ˆcalculateï¼‰
- å˜é‡ï¼š3ä¸ªï¼ˆoperation, a, bï¼‰

ğŸ“ˆ ä»£ç åº¦é‡ï¼š
- æ–¹æ³•è¡Œæ•°ï¼š26è¡Œ âš ï¸
- åœˆå¤æ‚åº¦ï¼š8
- åµŒå¥—æ·±åº¦ï¼š4å±‚

âš ï¸ é—®é¢˜åˆ—è¡¨ï¼š
1. [HIGH] æ·±å±‚åµŒå¥—ï¼šåµŒå¥—æ·±åº¦ä¸º4å±‚ï¼Œå»ºè®®ç®€åŒ–é€»è¾‘
2. [MEDIUM] é•¿æ–¹æ³•ï¼šæ–¹æ³•æœ‰26è¡Œï¼Œå»ºè®®åˆ†è§£

ğŸ’¡ é‡æ„å»ºè®®ï¼š
1. [HIGH] æå–æ–¹æ³•ï¼šå°†addæ“ä½œçš„å¤æ‚é€»è¾‘æå–ä¸ºç‹¬ç«‹æ–¹æ³•
2. [HIGH] æ—©æœŸè¿”å›ï¼šä½¿ç”¨æ—©æœŸè¿”å›å‡å°‘åµŒå¥—
3. [MEDIUM] ç­–ç•¥æ¨¡å¼ï¼šè€ƒè™‘ä½¿ç”¨ç­–ç•¥æ¨¡å¼æ›¿ä»£if-else

â­ è´¨é‡è¯„åˆ†ï¼š70/100
```

### 2. ä»£ç ç”Ÿæˆå™¨ï¼ˆCodeGeneratorï¼‰

ä»£ç ç”Ÿæˆå™¨æ˜¯AIç¼–ç¨‹åŠ©æ‰‹çš„"æ‰‹"ï¼Œè´Ÿè´£å¿«é€Ÿåˆ›å»ºä»£ç ã€‚

#### ç”Ÿæˆæµç¨‹

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant Generator as CodeGenerator
    participant Parser as éœ€æ±‚è§£æå™¨
    participant Template as æ¨¡æ¿å¼•æ“
    participant Context as ä¸Šä¸‹æ–‡æ¨æ–­å™¨
    
    User->>Generator: æäº¤ç”Ÿæˆè¯·æ±‚
    Generator->>Parser: è§£æéœ€æ±‚
    Parser->>Parser: è¯†åˆ«ä»£ç ç±»å‹
    Parser->>Context: æ¨æ–­å‚æ•°
    Context->>Context: ç±»å‹æ¨æ–­
    Context->>Context: å‘½åç”Ÿæˆ
    Context-->>Template: æä¾›å‚æ•°
    Template->>Template: åº”ç”¨æ¨¡æ¿
    Template-->>Generator: è¿”å›ä»£ç 
    Generator-->>User: ç”Ÿæˆçš„ä»£ç 
```

#### æ¨¡æ¿ç³»ç»Ÿ

ç³»ç»Ÿå†…ç½®å¤šç§ä»£ç æ¨¡æ¿ï¼š

**1. Javaæ–¹æ³•æ¨¡æ¿**

```java
/**
 * {description}
 * 
 * @param {parameters}
 * @return {returnType}
 */
{modifiers} {returnType} {methodName}({parameterList}) {
    // TODO: å®ç°æ–¹æ³•é€»è¾‘
    {defaultReturn}
}
```

**ä½¿ç”¨ç¤ºä¾‹**ï¼š

```java
// è¾“å…¥ï¼š
"åˆ›å»ºä¸€ä¸ªè·å–ç”¨æˆ·åçš„æ–¹æ³•"

// ç”Ÿæˆï¼š
/**
 * è·å–ç”¨æˆ·å
 * 
 * @param id ç”¨æˆ·ID
 * @return String ç”¨æˆ·å
 */
public String getUserName(int id) {
    // TODO: å®ç°æ–¹æ³•é€»è¾‘
    return null;
}
```

**2. Javaç±»æ¨¡æ¿**

```java
/**
 * {description}
 * 
 * @author TinyAI
 */
{modifiers} class {className} {extends} {
    
    // å­—æ®µ
    {fields}
    
    // æ„é€ æ–¹æ³•
    {constructors}
    
    // æ–¹æ³•
    {methods}
}
```

**3. JUnitæµ‹è¯•æ¨¡æ¿**

```java
@Test
public void test{MethodName}() {
    // Arrange
    {className} instance = new {className}();
    
    // Act
    {returnType} result = instance.{methodName}({parameters});
    
    // Assert
    assertNotNull(result);
}
```

#### æ™ºèƒ½æ¨æ–­æœºåˆ¶

ä»£ç ç”Ÿæˆå™¨èƒ½å¤ŸåŸºäºè‡ªç„¶è¯­è¨€æè¿°æ™ºèƒ½æ¨æ–­ä»£ç ç»†èŠ‚ï¼š

**1. è¿”å›ç±»å‹æ¨æ–­**

| å…³é”®è¯ | æ¨æ–­ç±»å‹ | ç¤ºä¾‹ |
|-------|---------|------|
| string, text, å­—ç¬¦ä¸² | String | "è·å–ç”¨æˆ·å" â†’ String |
| int, number, æ•°å­— | int | "è®¡ç®—å¹´é¾„" â†’ int |
| boolean, æ˜¯å¦ | boolean | "æ˜¯å¦æœ‰æ•ˆ" â†’ boolean |
| list, åˆ—è¡¨ | List | "è·å–ç”¨æˆ·åˆ—è¡¨" â†’ List |
| void, æ— è¿”å› | void | "ä¿å­˜ç”¨æˆ·" â†’ void |

**2. å‚æ•°æ¨æ–­**

```java
// è¾“å…¥ï¼š
"æ ¹æ®emailå’ŒpasswordéªŒè¯ç”¨æˆ·"

// æ¨æ–­å‚æ•°ï¼š
String email, String password

// ç”Ÿæˆä»£ç ï¼š
public boolean validateUser(String email, String password) {
    // TODO: å®ç°éªŒè¯é€»è¾‘
    return false;
}
```

**3. å‘½åè§„èŒƒ**

```java
// è‡ªåŠ¨è½¬æ¢ä¸ºé©¼å³°å‘½å
"get user name" â†’ getUserName
"save user data" â†’ saveUserData
"is valid email" â†’ isValidEmail

// éµå¾ªJavaå‘½åçº¦å®š
getteræ–¹æ³•ï¼šget + é¦–å­—æ¯å¤§å†™
setteræ–¹æ³•ï¼šset + é¦–å­—æ¯å¤§å†™
booleanæ–¹æ³•ï¼šis/has + é¦–å­—æ¯å¤§å†™
```

#### é«˜çº§ç”Ÿæˆèƒ½åŠ›

**1. æ ¹æ®å·²æœ‰ä»£ç ç”Ÿæˆæµ‹è¯•**

```java
// è¾“å…¥ä»£ç ï¼š
public class Calculator {
    public int add(int a, int b) {
        return a + b;
    }
}

// ç”Ÿæˆæµ‹è¯•ï¼š
@Test
public void testAdd() {
    // Arrange
    Calculator calculator = new Calculator();
    int a = 5;
    int b = 3;
    
    // Act
    int result = calculator.add(a, b);
    
    // Assert
    assertEquals(8, result);
}
```

**2. ç”ŸæˆBuilderæ¨¡å¼**

```java
// è¾“å…¥ï¼š
"ä¸ºUserç±»ç”ŸæˆBuilder"

// ç”Ÿæˆï¼š
public static class Builder {
    private String name;
    private int age;
    private String email;
    
    public Builder name(String name) {
        this.name = name;
        return this;
    }
    
    public Builder age(int age) {
        this.age = age;
        return this;
    }
    
    public Builder email(String email) {
        this.email = email;
        return this;
    }
    
    public User build() {
        return new User(this);
    }
}
```

### 3. é‡æ„ä»£ç†ï¼ˆRefactorAgentï¼‰

é‡æ„ä»£ç†æ˜¯AIç¼–ç¨‹åŠ©æ‰‹çš„"æ™ºå›Š"ï¼Œè´Ÿè´£å‘ç°ä»£ç æ”¹è¿›æœºä¼šã€‚

#### é‡æ„æ¨¡å¼è¯†åˆ«

```mermaid
graph LR
    subgraph "ä»£ç å¼‚å‘³æ£€æµ‹"
        A1[é•¿æ–¹æ³•<br/>è¡Œæ•°>50]
        A2[é‡å¤ä»£ç <br/>é‡å¤>3æ¬¡]
        A3[å¤§ç±»<br/>è¡Œæ•°>500]
        A4[æ·±å±‚åµŒå¥—<br/>>6å±‚]
        A5[é•¿å‚æ•°åˆ—è¡¨<br/>>5å‚æ•°]
        A6[å¤æ‚æ¡ä»¶<br/>å¤æ‚åº¦>10]
    end
    
    subgraph "é‡æ„ç­–ç•¥"
        B1[æå–æ–¹æ³•]
        B2[æå–å…¬å…±ä»£ç ]
        B3[æ‹†åˆ†ç±»]
        B4[æ—©æœŸè¿”å›]
        B5[å‚æ•°å¯¹è±¡]
        B6[ç®€åŒ–æ¡ä»¶]
    end
    
    A1 --> B1
    A2 --> B2
    A3 --> B3
    A4 --> B4
    A5 --> B5
    A6 --> B6
```

#### é‡æ„æ¨¡å¼è¯¦è§£

**1. æå–æ–¹æ³•ï¼ˆExtract Methodï¼‰**

**é€‚ç”¨åœºæ™¯**ï¼šæ–¹æ³•è¿‡é•¿ï¼Œé€»è¾‘å¤æ‚

**é‡æ„å‰**ï¼š

```java
public void processOrder(Order order) {
    // éªŒè¯è®¢å•ï¼ˆ10è¡Œä»£ç ï¼‰
    if (order == null) {
        throw new IllegalArgumentException("Order cannot be null");
    }
    if (order.getItems().isEmpty()) {
        throw new IllegalArgumentException("Order must have items");
    }
    
    // è®¡ç®—æ€»ä»·ï¼ˆ15è¡Œä»£ç ï¼‰
    double total = 0;
    for (OrderItem item : order.getItems()) {
        total += item.getPrice() * item.getQuantity();
    }
    order.setTotal(total);
    
    // ä¿å­˜è®¢å•ï¼ˆ8è¡Œä»£ç ï¼‰
    orderRepository.save(order);
    logService.log("Order saved: " + order.getId());
}
```

**é‡æ„å**ï¼š

```java
public void processOrder(Order order) {
    validateOrder(order);
    calculateTotal(order);
    saveOrder(order);
}

private void validateOrder(Order order) {
    if (order == null) {
        throw new IllegalArgumentException("Order cannot be null");
    }
    if (order.getItems().isEmpty()) {
        throw new IllegalArgumentException("Order must have items");
    }
}

private void calculateTotal(Order order) {
    double total = 0;
    for (OrderItem item : order.getItems()) {
        total += item.getPrice() * item.getQuantity();
    }
    order.setTotal(total);
}

private void saveOrder(Order order) {
    orderRepository.save(order);
    logService.log("Order saved: " + order.getId());
}
```

**2. æ—©æœŸè¿”å›ï¼ˆEarly Returnï¼‰**

**é€‚ç”¨åœºæ™¯**ï¼šæ·±å±‚åµŒå¥—çš„if-else

**é‡æ„å‰**ï¼š

```java
public String getDiscount(User user) {
    if (user != null) {
        if (user.isVip()) {
            if (user.getPoints() > 1000) {
                return "20%";
            } else {
                return "10%";
            }
        } else {
            return "5%";
        }
    } else {
        return "0%";
    }
}
```

**é‡æ„å**ï¼š

```java
public String getDiscount(User user) {
    if (user == null) {
        return "0%";
    }
    
    if (!user.isVip()) {
        return "5%";
    }
    
    if (user.getPoints() > 1000) {
        return "20%";
    }
    
    return "10%";
}
```

**3. å‚æ•°å¯¹è±¡ï¼ˆParameter Objectï¼‰**

**é€‚ç”¨åœºæ™¯**ï¼šå‚æ•°åˆ—è¡¨è¿‡é•¿

**é‡æ„å‰**ï¼š

```java
public User createUser(String name, int age, String email, 
                      String phone, String address, String city) {
    // ...
}
```

**é‡æ„å**ï¼š

```java
public class UserInfo {
    private String name;
    private int age;
    private String email;
    private String phone;
    private String address;
    private String city;
    
    // getters and setters
}

public User createUser(UserInfo userInfo) {
    // ...
}
```

#### é‡æ„å»ºè®®ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | è§¦å‘æ¡ä»¶ | å½±å“çº§åˆ« | å»ºè®®ç±»å‹ |
|-------|---------|---------|---------|
| **é«˜** | å¤§ç±»ï¼ˆ>500è¡Œï¼‰<br/>é‡å¤ä»£ç å¤šï¼ˆ>5å¤„ï¼‰ | é«˜ | æ‹†åˆ†ç±»<br/>æå–å…¬å…±æ–¹æ³• |
| **ä¸­** | é•¿æ–¹æ³•ï¼ˆ>50è¡Œï¼‰<br/>æ·±å±‚åµŒå¥—ï¼ˆ>6å±‚ï¼‰<br/>å¤æ‚æ¡ä»¶ï¼ˆå¤æ‚åº¦>10ï¼‰ | ä¸­ | æå–æ–¹æ³•<br/>æ—©æœŸè¿”å›<br/>ç®€åŒ–æ¡ä»¶ |
| **ä½** | é•¿å‚æ•°åˆ—è¡¨ï¼ˆ>5å‚æ•°ï¼‰ | ä½ | å‚æ•°å¯¹è±¡<br/>Builderæ¨¡å¼ |

### 4. è°ƒè¯•ä»£ç†ï¼ˆDebugAgentï¼‰

è°ƒè¯•ä»£ç†æ˜¯AIç¼–ç¨‹åŠ©æ‰‹çš„"åŒ»ç”Ÿ"ï¼Œè´Ÿè´£è¯Šæ–­å’Œä¿®å¤ä»£ç é—®é¢˜ã€‚

#### é”™è¯¯è¯Šæ–­æµç¨‹

```mermaid
flowchart TD
    INPUT([ä»£ç +é”™è¯¯ä¿¡æ¯]) --> SYNTAX_CHECK[è¯­æ³•é¢„æ£€æŸ¥]
    SYNTAX_CHECK --> SYNTAX_VALID{è¯­æ³•æœ‰æ•ˆ?}
    SYNTAX_VALID -->|å¦| SYNTAX_ERROR[è¯­æ³•é”™è¯¯è¯Šæ–­]
    SYNTAX_VALID -->|æ˜¯| LOGIC_CHECK[é€»è¾‘é”™è¯¯æ£€æŸ¥]
    LOGIC_CHECK --> RUNTIME_CHECK[è¿è¡Œæ—¶é£é™©åˆ†æ]
    RUNTIME_CHECK --> PATTERN_MATCH[é”™è¯¯æ¨¡å¼åŒ¹é…]
    
    SYNTAX_ERROR --> SUGGEST[ç”Ÿæˆä¿®å¤å»ºè®®]
    PATTERN_MATCH --> SUGGEST
    
    SUGGEST --> AUTO_FIX[å°è¯•è‡ªåŠ¨ä¿®å¤]
    AUTO_FIX --> RESULT[è¿”å›è¯Šæ–­ç»“æœ]
    RESULT --> END([ç»“æŸ])
```

#### é”™è¯¯æ¨¡å¼åº“

**1. NullPointerException**

**ç‰¹å¾è¯†åˆ«**ï¼š

```java
// å±é™©æ¨¡å¼ï¼š
object.method()  // objectå¯èƒ½ä¸ºnull
array[index]     // arrayå¯èƒ½ä¸ºnull
```

**è¯Šæ–­æ–¹æ³•**ï¼š

```java
1. æ£€æŸ¥å˜é‡åˆå§‹åŒ–
2. æ£€æŸ¥æ–¹æ³•è¿”å›å€¼
3. æ£€æŸ¥å‚æ•°ä¼ é€’
```

**ä¿®å¤å»ºè®®**ï¼š

```java
// ä¿®å¤å‰ï¼š
String name = user.getName();

// ä¿®å¤åï¼š
if (user != null) {
    String name = user.getName();
} else {
    String name = "Unknown";
}

// æˆ–ä½¿ç”¨Optionalï¼š
String name = Optional.ofNullable(user)
    .map(User::getName)
    .orElse("Unknown");
```

**2. ArrayIndexOutOfBoundsException**

**ç‰¹å¾è¯†åˆ«**ï¼š

```java
// å±é™©æ¨¡å¼ï¼š
for (int i = 0; i <= array.length; i++) {  // åº”è¯¥æ˜¯ <
    array[i] = value;
}
```

**ä¿®å¤å»ºè®®**ï¼š

```java
// ä¿®å¤å‰ï¼š
for (int i = 0; i <= array.length; i++) {
    array[i] = value;
}

// ä¿®å¤åï¼š
for (int i = 0; i < array.length; i++) {
    array[i] = value;
}

// æˆ–æ·»åŠ è¾¹ç•Œæ£€æŸ¥ï¼š
if (index >= 0 && index < array.length) {
    array[index] = value;
}
```

**3. StackOverflowError**

**ç‰¹å¾è¯†åˆ«**ï¼š

```java
// å±é™©æ¨¡å¼ï¼šæ— ç»ˆæ­¢æ¡ä»¶çš„é€’å½’
public int factorial(int n) {
    return n * factorial(n - 1);  // ç¼ºå°‘ç»ˆæ­¢æ¡ä»¶
}
```

**ä¿®å¤å»ºè®®**ï¼š

```java
// ä¿®å¤å‰ï¼š
public int factorial(int n) {
    return n * factorial(n - 1);
}

// ä¿®å¤åï¼š
public int factorial(int n) {
    if (n <= 1) {  // æ·»åŠ ç»ˆæ­¢æ¡ä»¶
        return 1;
    }
    return n * factorial(n - 1);
}
```

#### è‡ªåŠ¨ä¿®å¤èƒ½åŠ›

è°ƒè¯•ä»£ç†èƒ½å¤Ÿè‡ªåŠ¨ä¿®å¤æŸäº›å¸¸è§é”™è¯¯ï¼š

| é”™è¯¯ç±»å‹ | è‡ªåŠ¨ä¿®å¤èƒ½åŠ› | ç¤ºä¾‹ |
|---------|------------|------|
| **ç¼ºå°‘åˆ†å·** | âœ… å®Œå…¨æ”¯æŒ | `return value` â†’ `return value;` |
| **æ‹¬å·ä¸åŒ¹é…** | âœ… å®Œå…¨æ”¯æŒ | è‡ªåŠ¨è¡¥å…¨ç¼ºå¤±çš„æ‹¬å· |
| **ç©ºæŒ‡é’ˆé£é™©** | âš ï¸ å»ºè®®ä¿®å¤ | æ·»åŠ nullæ£€æŸ¥å»ºè®® |
| **æ•°ç»„è¶Šç•Œ** | âš ï¸ å»ºè®®ä¿®å¤ | æ·»åŠ è¾¹ç•Œæ£€æŸ¥å»ºè®® |
| **é€»è¾‘é”™è¯¯** | âŒ ä»…è¯Šæ–­ | éœ€è¦äººå·¥åˆ¤æ–­ä¿®å¤æ–¹æ¡ˆ |

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜æœºåˆ¶

ä¸ºäº†æé«˜å“åº”é€Ÿåº¦ï¼Œç³»ç»Ÿé‡‡ç”¨å¤šçº§ç¼“å­˜ç­–ç•¥ï¼š

```mermaid
graph TB
    REQUEST[åˆ†æè¯·æ±‚] --> CACHE_CHECK{ç¼“å­˜å­˜åœ¨?}
    CACHE_CHECK -->|æ˜¯| CACHE_HIT[è¿”å›ç¼“å­˜ç»“æœ]
    CACHE_CHECK -->|å¦| ANALYZE[æ‰§è¡Œåˆ†æ]
    ANALYZE --> CACHE_STORE[å­˜å‚¨åˆ°ç¼“å­˜]
    CACHE_STORE --> RETURN[è¿”å›ç»“æœ]
    CACHE_HIT --> RETURN
```

**ç¼“å­˜ç­–ç•¥**ï¼š

| ç¼“å­˜ç±»å‹ | ç¼“å­˜å†…å®¹ | è¿‡æœŸç­–ç•¥ | å‘½ä¸­ç‡ç›®æ ‡ |
|---------|---------|---------|-----------|
| **åˆ†æç»“æœ** | ä»£ç åˆ†ææŠ¥å‘Š | ä»£ç å†…å®¹å˜åŒ–æ—¶å¤±æ•ˆ | >80% |
| **æ¨¡æ¿** | ä»£ç ç”Ÿæˆæ¨¡æ¿ | ç³»ç»Ÿé‡å¯æ—¶å¤±æ•ˆ | >95% |
| **æ¨¡å¼åº“** | é‡æ„æ¨¡å¼ã€é”™è¯¯æ¨¡å¼ | æ°¸ä¹…ç¼“å­˜ | 100% |

### æ€§èƒ½æŒ‡æ ‡

| æ“ä½œç±»å‹ | å°å‹ä»£ç (<100è¡Œ) | ä¸­å‹ä»£ç (100-500è¡Œ) | å¤§å‹ä»£ç (>500è¡Œ) |
|---------|-----------------|-------------------|-----------------|
| ä»£ç åˆ†æ | <20ms | <100ms | <500ms |
| ä»£ç ç”Ÿæˆ | <10ms | <20ms | <100ms |
| é‡æ„å»ºè®® | <50ms | <200ms | <800ms |
| é”™è¯¯è°ƒè¯• | <30ms | <150ms | <600ms |

## å®æˆ˜æ¼”ç»ƒ

### æ¼”ç¤º1ï¼šä»£ç è´¨é‡æ£€æŸ¥

```java
// 1. åˆ›å»ºAIç¼–ç¨‹åŠ©æ‰‹
AICodingCursor cursor = new AICodingCursor();

// 2. å¾…åˆ†æçš„ä»£ç 
String code = """
    public class UserService {
        public User getUser(int id) {
            if (id > 0) {
                if (id < 1000) {
                    User user = database.findUser(id);
                    if (user != null) {
                        if (user.isActive()) {
                            return user;
                        }
                    }
                }
            }
            return null;
        }
    }
    """;

// 3. æ‰§è¡Œåˆ†æ
String analysis = cursor.analyzeCode(code);
System.out.println(analysis);
```

**è¾“å‡º**ï¼š

```
=== ä»£ç åˆ†ææŠ¥å‘Š ===

âœ“ è¯­æ³•æ£€æŸ¥ï¼šé€šè¿‡

ğŸ“Š ä»£ç ç»“æ„ï¼š
- ç±»ï¼š1ä¸ª
- æ–¹æ³•ï¼š1ä¸ª
- åœˆå¤æ‚åº¦ï¼š5
- åµŒå¥—æ·±åº¦ï¼š4å±‚

âš ï¸ é—®é¢˜åˆ—è¡¨ï¼š
1. [HIGH] æ·±å±‚åµŒå¥—ï¼ˆ4å±‚ï¼‰ï¼šå»ºè®®ä½¿ç”¨æ—©æœŸè¿”å›ç®€åŒ–é€»è¾‘

ğŸ’¡ é‡æ„å»ºè®®ï¼š
1. [HIGH] æ—©æœŸè¿”å›ï¼šå‡å°‘åµŒå¥—æ·±åº¦ï¼Œæé«˜å¯è¯»æ€§

â­ è´¨é‡è¯„åˆ†ï¼š75/100
```

### æ¼”ç¤º2ï¼šæ™ºèƒ½ä»£ç ç”Ÿæˆ

```java
// ç”Ÿæˆç”¨æˆ·æœåŠ¡æ–¹æ³•
String description = "åˆ›å»ºä¸€ä¸ªæ ¹æ®emailæŸ¥æ‰¾ç”¨æˆ·çš„æ–¹æ³•";
String generated = cursor.generateCode(description);
System.out.println(generated);
```

**è¾“å‡º**ï¼š

```java
/**
 * æ ¹æ®emailæŸ¥æ‰¾ç”¨æˆ·
 * 
 * @param email ç”¨æˆ·é‚®ç®±
 * @return User ç”¨æˆ·å¯¹è±¡
 */
public User findUserByEmail(String email) {
    // TODO: å®ç°æŸ¥æ‰¾é€»è¾‘
    return null;
}
```

### æ¼”ç¤º3ï¼šé‡æ„å»ºè®®

```java
String codeWithSmell = """
    public void processData(String data) {
        // 50è¡Œå¤æ‚é€»è¾‘...
        // åŒ…å«é‡å¤ä»£ç ...
    }
    """;

List<String> suggestions = cursor.suggestRefactoring(codeWithSmell);
suggestions.forEach(System.out::println);
```

**è¾“å‡º**ï¼š

```
[HIGH] æå–æ–¹æ³•ï¼šå°†æ•°æ®éªŒè¯é€»è¾‘æå–ä¸ºç‹¬ç«‹æ–¹æ³•
[HIGH] æå–å…¬å…±ä»£ç ï¼šå‘ç°3å¤„é‡å¤ä»£ç ï¼Œå»ºè®®æå–å…¬å…±æ–¹æ³•
[MEDIUM] ç®€åŒ–æ¡ä»¶ï¼šå¤æ‚çš„if-elseå¯ä»¥ç”¨ç­–ç•¥æ¨¡å¼ç®€åŒ–
```

### æ¼”ç¤º4ï¼šé”™è¯¯è¯Šæ–­

```java
String buggyCode = """
    public int divide(int a, int b) {
        return a / b;  // å¯èƒ½é™¤ä»¥0
    }
    """;

String errorMsg = "java.lang.ArithmeticException: / by zero";
String diagnosis = cursor.diagnoseError(buggyCode, errorMsg);
System.out.println(diagnosis);
```

**è¾“å‡º**ï¼š

```
=== é”™è¯¯è¯Šæ–­æŠ¥å‘Š ===

ğŸ› é”™è¯¯ç±»å‹ï¼šArithmeticExceptionï¼ˆç®—æœ¯å¼‚å¸¸ï¼‰

ğŸ” é—®é¢˜åˆ†æï¼š
é™¤æ•°bå¯èƒ½ä¸º0ï¼Œå¯¼è‡´é™¤æ³•è¿ç®—å¤±è´¥

ğŸ’¡ ä¿®å¤å»ºè®®ï¼š
åœ¨æ‰§è¡Œé™¤æ³•å‰æ·»åŠ é™¤æ•°æ£€æŸ¥ï¼š

if (b == 0) {
    throw new IllegalArgumentException("é™¤æ•°ä¸èƒ½ä¸º0");
}
return a / b;

æˆ–è€…è¿”å›ç‰¹æ®Šå€¼ï¼š

if (b == 0) {
    return 0; // æˆ–å…¶ä»–é»˜è®¤å€¼
}
return a / b;
```

## åº”ç”¨åœºæ™¯

### åœºæ™¯1ï¼šæ—¥å¸¸å¼€å‘è¾…åŠ©

**ä½¿ç”¨æµç¨‹**ï¼š

1. ç¼–å†™ä»£ç æ—¶å®æ—¶æ£€æŸ¥è´¨é‡
2. å¿«é€Ÿç”Ÿæˆæ ·æ¿ä»£ç 
3. è·å–é‡æ„å»ºè®®
4. è¯Šæ–­ç¼–è¯‘/è¿è¡Œé”™è¯¯

**æ•ˆæœ**ï¼š

- ä»£ç è´¨é‡æå‡20-30%
- å¼€å‘æ•ˆç‡æå‡30-50%
- Bugæ•°é‡å‡å°‘40%

### åœºæ™¯2ï¼šä»£ç å®¡æŸ¥

**ä½¿ç”¨æµç¨‹**ï¼š

1. æäº¤ä»£ç è¿›è¡Œè‡ªåŠ¨å®¡æŸ¥
2. ç”Ÿæˆè¯¦ç»†çš„è´¨é‡æŠ¥å‘Š
3. è¯†åˆ«æ½œåœ¨é—®é¢˜å’Œé£é™©
4. æä¾›æ”¹è¿›å»ºè®®

**æ•ˆæœ**ï¼š

- å®¡æŸ¥æ•ˆç‡æå‡60%
- å®¡æŸ¥ä¸€è‡´æ€§æé«˜
- å‘ç°æ›´å¤šæ½œåœ¨é—®é¢˜

### åœºæ™¯3ï¼šå­¦ä¹ å’Œæ•™è‚²

**ä½¿ç”¨æµç¨‹**ï¼š

1. åˆ†æç¤ºä¾‹ä»£ç ç†è§£ç»“æ„
2. å­¦ä¹ æœ€ä½³å®è·µ
3. ç»ƒä¹ é‡æ„æŠ€å·§
4. ç†è§£é”™è¯¯åŸå› 

**æ•ˆæœ**ï¼š

- å­¦ä¹ æ•ˆç‡æå‡50%
- ç†è§£æ›´æ·±å…¥
- å¿«é€ŸæŒæ¡æœ€ä½³å®è·µ

## æ‰©å±•å¼€å‘

### æ·»åŠ è‡ªå®šä¹‰æ¨¡æ¿

```java
// 1. åˆ›å»ºæ¨¡æ¿
String template = """
    @RestController
    @RequestMapping("/api/{resource}")
    public class {ClassName}Controller {
        
        @Autowired
        private {ClassName}Service service;
        
        @GetMapping
        public List<{ClassName}> getAll() {
            return service.findAll();
        }
        
        @PostMapping
        public {ClassName} create(@RequestBody {ClassName} entity) {
            return service.save(entity);
        }
    }
    """;

// 2. æ³¨å†Œæ¨¡æ¿
cursor.registerTemplate("rest_controller", template);

// 3. ä½¿ç”¨æ¨¡æ¿
String code = cursor.generateFromTemplate("rest_controller", 
    Map.of("ClassName", "User", "resource", "users"));
```

### æ·»åŠ è‡ªå®šä¹‰é‡æ„è§„åˆ™

```java
// 1. å®šä¹‰é‡æ„è§„åˆ™
RefactorRule customRule = new RefactorRule() {
    @Override
    public boolean matches(String code) {
        // æ£€æµ‹æ˜¯å¦åŒ¹é…è§„åˆ™
        return code.contains("System.out.println");
    }
    
    @Override
    public String suggest() {
        return "ä½¿ç”¨æ—¥å¿—æ¡†æ¶æ›¿ä»£System.out.println";
    }
    
    @Override
    public String refactor(String code) {
        // æ‰§è¡Œé‡æ„
        return code.replace("System.out.println", "logger.info");
    }
};

// 2. æ³¨å†Œè§„åˆ™
cursor.registerRefactorRule(customRule);
```

## æœ€ä½³å®è·µ

### 1. æŒç»­è´¨é‡æ£€æŸ¥

```java
// åœ¨CI/CDæµç¨‹ä¸­é›†æˆ
public class CodeQualityCheck {
    public void checkBeforeCommit(String code) {
        AICodingCursor cursor = new AICodingCursor();
        String report = cursor.analyzeCode(code);
        
        // è§£æè¯„åˆ†
        int score = extractScore(report);
        
        // è´¨é‡é—¨ç¦
        if (score < 70) {
            throw new RuntimeException("ä»£ç è´¨é‡ä¸è¾¾æ ‡ï¼Œè¯„åˆ†ï¼š" + score);
        }
    }
}
```

### 2. æ¸è¿›å¼é‡æ„

```java
// ä¸è¦ä¸€æ¬¡æ€§é‡æ„æ‰€æœ‰ä»£ç 
// æŒ‰ä¼˜å…ˆçº§é€æ­¥æ”¹è¿›
List<String> suggestions = cursor.suggestRefactoring(code);

// å…ˆå¤„ç†HIGHä¼˜å…ˆçº§
suggestions.stream()
    .filter(s -> s.startsWith("[HIGH]"))
    .forEach(this::applyRefactoring);
```

### 3. ç»“åˆäººå·¥åˆ¤æ–­

```java
// AIæä¾›å»ºè®®ï¼Œäººå·¥åšæœ€ç»ˆå†³ç­–
String diagnosis = cursor.diagnoseError(code, error);
System.out.println("AIå»ºè®®ï¼š" + diagnosis);

// äººå·¥å®¡æŸ¥åå†³å®šæ˜¯å¦é‡‡çº³
if (confirmWithDeveloper(diagnosis)) {
    applyFix(diagnosis);
}
```

## å°ç»“

æœ¬èŠ‚æˆ‘ä»¬æ·±å…¥å­¦ä¹ äº†AIç¼–ç¨‹åŠ©æ‰‹çš„è®¾è®¡ä¸å®ç°ï¼š

### æ ¸å¿ƒè¦ç‚¹

1. **ä»£ç åˆ†æå™¨**ï¼šå¤šç»´åº¦åˆ†æä»£ç ï¼Œæä¾›è´¨é‡è¯„åˆ†
2. **ä»£ç ç”Ÿæˆå™¨**ï¼šåŸºäºæ¨¡æ¿å’Œæ™ºèƒ½æ¨æ–­å¿«é€Ÿç”Ÿæˆä»£ç 
3. **é‡æ„ä»£ç†**ï¼šè¯†åˆ«ä»£ç å¼‚å‘³ï¼Œæä¾›é‡æ„å»ºè®®
4. **è°ƒè¯•ä»£ç†**ï¼šè¯Šæ–­é”™è¯¯ï¼Œå»ºè®®ä¿®å¤æ–¹æ¡ˆ

### è®¾è®¡åŸåˆ™

- **æ¨¡å—åŒ–**ï¼šæ¯ä¸ªç»„ä»¶èŒè´£å•ä¸€ï¼Œæ˜“äºç»´æŠ¤
- **å¯æ‰©å±•**ï¼šæ”¯æŒè‡ªå®šä¹‰æ¨¡æ¿å’Œè§„åˆ™
- **é«˜æ€§èƒ½**ï¼šé‡‡ç”¨ç¼“å­˜æœºåˆ¶ä¼˜åŒ–å“åº”æ—¶é—´
- **æ™ºèƒ½åŒ–**ï¼šç»“åˆæ¨¡å¼åŒ¹é…å’ŒLLMæ¨ç†

### å®è·µå»ºè®®

- ä»ç®€å•åŠŸèƒ½å¼€å§‹ï¼Œé€æ­¥å¢å¼º
- æŒç»­ç§¯ç´¯æ¨¡å¼åº“å’Œæ¨¡æ¿åº“
- ç»“åˆå®é™…é¡¹ç›®éªŒè¯æ•ˆæœ
- ä¿æŒäººæœºåä½œï¼Œä¸è¦å®Œå…¨ä¾èµ–AI

### ä¸‹ä¸€æ­¥

ä¸‹ä¸€èŠ‚æˆ‘ä»¬å°†å­¦ä¹ **æ‰‹ç¨¿æ™ºèƒ½ä½“**ï¼Œæ¢ç´¢æ›´é«˜çº§çš„åˆ†å±‚æ¶æ„å’ŒReActæ¨ç†æ¨¡å¼ã€‚

---

**ç›¸å…³èµ„æº**ï¼š
- [ä»£ç ç¤ºä¾‹](../../../tinyai-agent-cursor/src/main/java/io/leavesfly/tinyai/agent/cursor/)
- [æŠ€æœ¯æ–‡æ¡£](../../../tinyai-agent-cursor/doc/TinyAI-CursoræŠ€æœ¯æ¶æ„æ–‡æ¡£.md)
- [æ¼”ç¤ºç¨‹åº](../../../tinyai-agent-cursor/src/test/java/io/leavesfly/tinyai/agent/cursor/CursorDemo.java)

**ä¸‹ä¸€èŠ‚**ï¼š[20.2 æ‰‹ç¨¿æ™ºèƒ½ä½“ï¼šåˆ†å±‚æ¶æ„çš„è‰ºæœ¯](20.2-manus-agent.md)
